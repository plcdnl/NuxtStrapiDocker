"use strict";(self.webpackChunkbackend=self.webpackChunkbackend||[]).push([[5895],{10608:(te,T,t)=>{t.r(T),t.d(T,{SettingsPage:()=>Jt,default:()=>qt});var e=t(67294),h=t(68547),i=t(49656),ne=t(17034),Y=t(97132),Qe=t(15482),ie=t(48474),Pe=t(38683),Ze=t(23724),Ie=t(67838),tt=t(49066),X=t(185),L=t(41580),b=t(11276),be=t(74571),$=t(75515),Ae=t(7681),k=t(29728),je=t(36182),ee=t(17772),B=t(85018),Ye=t(87751),w=t(45697),f=t.n(w);const ze=750,le=100,Ge=["image/jpeg","image/png","image/svg+xml"];var we=t(73987),ct=t(17973),nt=t(59689),Ke=t(12028),at=t(96315),st=t(30815),it=t(42866),oe=t(24969),Je=t(18172);const re={localImage:void 0},Ce=(g=re,d)=>(0,Je.default)(g,m=>{switch(d.type){case"SET_LOCAL_IMAGE":{m.localImage=d.value;break}default:return m}}),N=({onChangeLogo:g,customLogo:d,goTo:m,Component:C,modalTitle:c,next:O,prev:U,currentStep:Q})=>{const[{localImage:de},q]=(0,e.useReducer)(Ce,re),{formatMessage:ye}=(0,Y.useIntl)(),H=Be=>{q({type:"SET_LOCAL_IMAGE",value:Be})},Fe=()=>{m(null)};return Q?e.createElement(it.P,{labelledBy:"modal",onClose:Fe},e.createElement(oe.x,null,e.createElement($.Z,{fontWeight:"bold",as:"h2",id:"modal"},ye(c))),e.createElement(C,{setLocalImage:H,goTo:m,next:O,prev:U,onClose:Fe,asset:de||d,onChangeLogo:g})):null};N.defaultProps={Component:void 0,currentStep:void 0,customLogo:void 0,modalTitle:void 0,next:null,prev:null},N.propTypes={Component:f().elementType,currentStep:f().string,customLogo:f().shape({name:f().string,url:f().string,width:f().number,height:f().number,ext:f().string}),goTo:f().func.isRequired,modalTitle:f().shape({id:f().string,defaultMessage:f().string}),next:f().string,onChangeLogo:f().func.isRequired,prev:f().string};const Ee=N,J={currentStep:void 0},Ue=(g=J,d)=>(0,Je.default)(g,m=>{switch(d.type){case"GO_TO":{m.currentStep=d.to;break}default:return m}});var Oe=t(82777),ce=t(60633),Re=t(42761),Ve=t(70004),qe=t(27821),E=t(11047),_e=t(52624),R=t(36856),Z=t(45377),W=t(54574),se=t(96404),K=t(35957);const pe={id:"Settings.application.customization.modal.upload.error-format",defaultMessage:"Wrong format uploaded (accepted formats only: jpeg, jpg, png, svg)."},Me={id:"Settings.application.customization.modal.upload.error-size",defaultMessage:"The file uploaded is too large (max dimension: {dimension}x{dimension}, max file size: {size}KB)"},$e=g=>new Promise(d=>{const m=new FileReader;m.onload=()=>{const C=new Image;C.onload=function(){d({width:C.width,height:C.height})},C.src=m.result},m.readAsDataURL(g)}),dt=(g,d)=>({ext:g.name.split(".").pop(),size:g.size/1e3,name:g.name,url:URL.createObjectURL(g),rawFile:g,width:d.width,height:d.height}),M=async g=>{let d;if(!Ge.includes(g.type))throw d=new Error("File format"),d.displayMessage=pe,d;const C=await $e(g);if(!(C.width<=ze&&C.height<=ze))throw d=new Error("File sizing"),d.displayMessage=Me,d;const O=dt(g,C);if(!(O.size<=le))throw d=new Error("File sizing"),d.displayMessage=Me,d;return O},ve=(0,qe.default)(Z._)`
  opacity: 0;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
`,ut=({setLocalImage:g,goTo:d,next:m,onClose:C})=>{const{formatMessage:c}=(0,Y.useIntl)(),[O,U]=(0,e.useState)(!1),[Q,de]=(0,e.useState)(void 0),q=(0,e.useRef)(null),ye=()=>U(!0),H=()=>U(!1),Fe=ot=>{ot.preventDefault(),q.current.click()},Be=async()=>{H();const ot=q.current.files[0];if(ot)try{const lt=await M(ot);g(lt),d(m)}catch(lt){if(lt.displayMessage)de(c(lt.displayMessage,{size:le,dimension:ze})),q.current.focus();else throw lt}},He=()=>O?"primary500":Q?"danger600":"neutral300";return e.createElement(e.Fragment,null,e.createElement("form",null,e.createElement(L.x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(W.g,{name:"logo-upload",error:Q},e.createElement("label",{htmlFor:"logo-upload"},e.createElement(Ae.K,{spacing:2},e.createElement(E.k,{paddingTop:9,paddingBottom:7,hasRadius:!0,justifyContent:"center",direction:"column",background:O?"primary100":"neutral100",borderColor:He(),borderStyle:"dashed",borderWidth:"1px",position:"relative",onDragEnter:ye,onDragLeave:H},e.createElement(_e.J,{color:"primary600",width:`${60/16}rem`,height:`${60/16}rem`,as:K.Z,"aria-hidden":!0}),e.createElement(L.x,{paddingTop:3,paddingBottom:5},e.createElement($.Z,{variant:"delta",as:"span"},c({id:"Settings.application.customization.modal.upload.drag-drop",defaultMessage:"Drag and Drop here or"}))),e.createElement(ve,{accept:Ge,cursor:"pointer",as:"input",type:"file",name:"files",tabIndex:-1,zIndex:1,onChange:Be,ref:q,id:"logo-upload"}),e.createElement(k.z,{type:"button",onClick:Fe},c({id:"Settings.application.customization.modal.upload.cta.browse",defaultMessage:"Browse files"})),e.createElement(L.x,{paddingTop:6},e.createElement($.Z,{variant:"pi",textColor:"neutral600"},c({id:"Settings.application.customization.modal.upload.file-validation",defaultMessage:"Max dimension: {dimension}x{dimension}, Max size: {size}KB"},{size:le,dimension:ze})))),e.createElement(se.c,null)))))),e.createElement(R.m,{startActions:e.createElement(k.z,{onClick:C,variant:"tertiary"},c({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"}))}))};ut.defaultProps={next:null},ut.propTypes={goTo:f().func.isRequired,next:f().string,onClose:f().func.isRequired,setLocalImage:f().func.isRequired};const At=ut;var Nt=t(16364),Zt=t(11817);const In=async g=>{try{const d=await Zt.Z.get(g,{responseType:"blob",timeout:8e3});return new File([d.data],d.config.url,{type:d.headers["content-type"]})}catch(d){throw d.displayMessage={id:"Settings.application.customization.modal.upload.error-network",defaultMessage:"Network error"},d}},ht=({goTo:g,next:d,onClose:m,setLocalImage:C})=>{const{formatMessage:c}=(0,Y.useIntl)(),[O,U]=(0,e.useState)(""),[Q,de]=(0,e.useState)(null),q=H=>{U(H.target.value)},ye=async()=>{try{const H=await In(O),Fe=await M(H);C(Fe),g(d)}catch(H){if(H.displayMessage)de(c(H.displayMessage,{size:le,dimension:ze}));else throw H}};return e.createElement("form",{onSubmit:H=>{H.preventDefault(),ye()}},e.createElement(L.x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(Nt.o,{label:c({id:"Settings.application.customization.modal.upload.from-url.input-label",defaultMessage:"URL"}),error:Q,onChange:q,value:O,name:"logo-url"})),e.createElement(R.m,{startActions:e.createElement(k.z,{onClick:m,variant:"tertiary"},c({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(k.z,{type:"submit"},c({id:"Settings.application.customization.modal.upload.next",defaultMessage:"Next"}))}))};ht.defaultProps={next:null},ht.propTypes={goTo:f().func.isRequired,next:f().string,onClose:f().func.isRequired,setLocalImage:f().func.isRequired};const On=ht,et=({setLocalImage:g,goTo:d,next:m,onClose:C})=>{const{formatMessage:c}=(0,Y.useIntl)();return e.createElement(Oe.v,{label:c({id:"Settings.application.customization.modal.tab.label",defaultMessage:"How do you want to upload your assets?"}),variant:"simple"},e.createElement(L.x,{paddingLeft:8,paddingRight:8},e.createElement(ce.m,null,e.createElement(ce.O,null,c({id:"Settings.application.customization.modal.upload.from-computer",defaultMessage:"From computer"})),e.createElement(ce.O,null,c({id:"Settings.application.customization.modal.upload.from-url",defaultMessage:"From url"}))),e.createElement(Ve.i,null)),e.createElement(Re.n,null,e.createElement(Re.x,null,e.createElement(At,{onClose:C,setLocalImage:g,goTo:d,next:m})),e.createElement(Re.x,null,e.createElement(On,{onClose:C,setLocalImage:g,goTo:d,next:m}))))};et.defaultProps={next:null},et.propTypes={goTo:f().func.isRequired,next:f().string,onClose:f().func.isRequired,setLocalImage:f().func.isRequired};const Fn=et;var tn=t(99220),nn=t(19093),Bn=t(87535),Ct=t(25001),Nn=t(75517),mt=t(20799),jt=t(41384);const Rt=({asset:g})=>{const{formatMessage:d}=(0,Y.useIntl)();return e.createElement(tn.Z,null,e.createElement(nn.O,null,e.createElement(Bn.H,{size:"S",src:g.url})),e.createElement(Ct.e,null,e.createElement(Nn.a,null,e.createElement(mt.l,null,g.name),e.createElement(mt._,null,`${g.ext.toUpperCase()} - ${g.width}\u2715${g.height}`)),e.createElement(jt.E,null,d({id:"Settings.application.customization.modal.pending.card-badge",defaultMessage:"image"}))))};Rt.propTypes={asset:f().shape({name:f().string,url:f().string,width:f().number,height:f().number,ext:f().string}).isRequired};const zt=Rt,Mt=({onClose:g,asset:d,prev:m,next:C,goTo:c,setLocalImage:O,onChangeLogo:U})=>{const{formatMessage:Q}=(0,Y.useIntl)(),de=()=>{O(void 0),c(m)},q=()=>{U(d),c(C)};return e.createElement(e.Fragment,null,e.createElement(L.x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(E.k,{justifyContent:"space-between",paddingBottom:6},e.createElement(E.k,{direction:"column",alignItems:"flex-start"},e.createElement($.Z,{variant:"pi",fontWeight:"bold"},Q({id:"Settings.application.customization.modal.pending.title",defaultMessage:"Logo ready to upload"})),e.createElement($.Z,{variant:"pi",textColor:"neutral500"},Q({id:"Settings.application.customization.modal.pending.subtitle",defaultMessage:"Manage the chosen logo before uploading it"}))),e.createElement(k.z,{onClick:de,variant:"secondary"},Q({id:"Settings.application.customization.modal.pending.choose-another",defaultMessage:"Choose another logo"}))),e.createElement(L.x,{maxWidth:(0,h.pxToRem)(180)},e.createElement(zt,{asset:d}))),e.createElement(R.m,{startActions:e.createElement(k.z,{onClick:g,variant:"tertiary"},Q({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(k.z,{onClick:q},Q({id:"Settings.application.customization.modal.pending.upload",defaultMessage:"Upload logo"}))}))};Mt.defaultProps={next:null,prev:null},Mt.propTypes={goTo:f().func.isRequired,asset:f().shape({name:f().string,url:f().string,width:f().number,height:f().number,ext:f().string}).isRequired,next:f().string,onClose:f().func.isRequired,onChangeLogo:f().func.isRequired,prev:f().string,setLocalImage:f().func.isRequired};const Ut={upload:{Component:Fn,modalTitle:{id:"Settings.application.customization.modal.upload",defaultMessage:"Upload logo"},next:"pending",prev:null},pending:{Component:Mt,modalTitle:{id:"Settings.application.customization.modal.pending",defaultMessage:"Pending logo"},next:null,prev:"upload"}},Dt=({canUpdate:g,customLogo:d,defaultLogo:m,hint:C,label:c,onChangeLogo:O,onResetLogo:U})=>{const[{currentStep:Q},de]=(0,e.useReducer)(Ue,J),{Component:q,next:ye,prev:H,modalTitle:Fe}=Ut[Q]||{},{formatMessage:Be}=(0,Y.useIntl)(),He=ot=>{de({type:"GO_TO",to:ot})};return e.createElement(e.Fragment,null,e.createElement(we.F,{label:c,selectedSlide:0,hint:C,previousLabel:"",nextLabel:"",onNext:()=>{},onPrevious:()=>{},secondaryLabel:d?.name||"logo.png",actions:e.createElement(ct.b,null,e.createElement(Ke.h,{disabled:!g,onClick:()=>He(d?"pending":"upload"),label:Be({id:"Settings.application.customization.carousel.change-action",defaultMessage:"Change logo"}),icon:e.createElement(at.default,null)}),d&&e.createElement(Ke.h,{disabled:!g,onClick:U,label:Be({id:"Settings.application.customization.carousel.reset-action",defaultMessage:"Reset logo"}),icon:e.createElement(st.Z,null)}))},e.createElement(nt.q,{label:Be({id:"Settings.application.customization.carousel-slide.label",defaultMessage:"Logo slide"})},e.createElement(L.x,{maxHeight:"40%",maxWidth:"40%",as:"img",src:d?.url||m,alt:Be({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"})}))),e.createElement(Ee,{Component:q,currentStep:Q,onChangeLogo:O,customLogo:d,goTo:He,next:ye,prev:H,modalTitle:Fe}))};Dt.defaultProps={canUpdate:!1,customLogo:null,hint:null},Dt.propTypes={canUpdate:f().bool,customLogo:f().shape({url:f().string,name:f().string}),label:f().string.isRequired,hint:f().string,defaultLogo:f().string.isRequired,onChangeLogo:f().func.isRequired,onResetLogo:f().func.isRequired};const Lt=Dt,xt={menuLogo:{display:null,submit:{rawFile:null,isReset:!1}},authLogo:{display:null,submit:{rawFile:null,isReset:!1}}},sn=(g=xt,d)=>(0,Je.default)(g,m=>{switch(d.type){case"SET_CUSTOM_MENU_LOGO":{m.menuLogo.display=d.value,m.menuLogo.submit.rawFile=d.value.rawFile;break}case"SET_CUSTOM_AUTH_LOGO":{m.authLogo.display=d.value,m.authLogo.submit.rawFile=d.value.rawFile;break}case"RESET_CUSTOM_MENU_LOGO":{m.menuLogo.display=null,m.menuLogo.submit={rawFile:null,isReset:!0};break}case"RESET_CUSTOM_AUTH_LOGO":{m.authLogo.display=null,m.authLogo.submit={rawFile:null,isReset:!0};break}default:return m}});var $t=t(82492),ln=t.n($t);const cn=(g,d)=>ln()(g,{menuLogo:{display:d.menuLogo},authLogo:{display:d.authLogo}}),pt=(0,e.forwardRef)(({canUpdate:g,projectSettingsStored:d},m)=>{const{formatMessage:C}=(0,Y.useIntl)(),{trackUsage:c}=(0,h.useTracking)(),{logos:{menu:O,auth:U}}=(0,ie.um)(),[{menuLogo:Q,authLogo:de},q]=(0,e.useReducer)(sn,xt,()=>cn(xt,d)),ye=He=>{q({type:"SET_CUSTOM_MENU_LOGO",value:He})},H=()=>{c("didClickResetLogo",{logo:"menu"}),q({type:"RESET_CUSTOM_MENU_LOGO"})},Fe=He=>{q({type:"SET_CUSTOM_AUTH_LOGO",value:He})},Be=()=>{c("didClickResetLogo",{logo:"auth"}),q({type:"RESET_CUSTOM_AUTH_LOGO"})};return(0,e.useImperativeHandle)(m,()=>({getValues:()=>({menuLogo:Q.submit,authLogo:de.submit})})),e.createElement(L.x,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement($.Z,{variant:"delta",as:"h3"},C({id:"Settings.application.customization",defaultMessage:"Customization"})),e.createElement($.Z,{variant:"pi",textColor:"neutral600"},C({id:"Settings.application.customization.size-details",defaultMessage:"Max dimension: {dimension}\xD7{dimension}, Max file size: {size}KB"},{dimension:ze,size:le})),e.createElement(b.r,{paddingTop:4,gap:4},e.createElement(be.P,{col:6,s:12},e.createElement(Lt,{canUpdate:g,customLogo:Q.display,defaultLogo:O.default,hint:C({id:"Settings.application.customization.menu-logo.carousel-hint",defaultMessage:"Replace the logo in the main navigation"}),label:C({id:"Settings.application.customization.carousel.menu-logo.title",defaultMessage:"Menu logo"}),onChangeLogo:ye,onResetLogo:H})),e.createElement(be.P,{col:6,s:12},e.createElement(Lt,{canUpdate:g,customLogo:de.display,defaultLogo:U.default,hint:C({id:"Settings.application.customization.auth-logo.carousel-hint",defaultMessage:"Replace the logo in the authentication pages"}),label:C({id:"Settings.application.customization.carousel.auth-logo.title",defaultMessage:"Auth logo"}),onChangeLogo:Fe,onResetLogo:Be}))))});pt.defaultProps={canUpdate:!1,projectSettingsStored:null},pt.propTypes={canUpdate:f().bool,projectSettingsStored:f().shape({menuLogo:f().shape({url:f().string,name:f().string})})};const dn=pt;var Zn=t(68718),Wt=t.n(Zn);const kt=g=>Wt()(g,(d,m,C)=>{m&&m.url?d[C]={...m,url:(0,h.prefixFileUrlWithBackendUrl)(m.url)}:d[C]=m},{}),un=async()=>{const{get:g}=(0,h.getFetchClient)(),{data:d}=await g("/admin/project-settings");return kt(d)},mn=async g=>{const{post:d}=(0,h.getFetchClient)(),{data:m}=await d("/admin/project-settings",g,{headers:{"Content-Type":"multipart/form-data"}});return kt(m)},Pt=g=>{const d=new FormData;return Object.entries(g).forEach(([m,C])=>{C&&C.rawFile instanceof File&&d.append(m,C.rawFile),C&&C.isReset&&d.append(m,null)}),d},Gt=()=>{const g=(0,e.useRef)(),d=(0,h.useNotification)(),{trackUsage:m}=(0,h.useTracking)(),{formatMessage:C}=(0,Y.useIntl)(),c=(0,Ze.useQueryClient)();(0,h.useFocusWhenNavigate)();const O=(0,h.useAppInfos)(),{shouldUpdateStrapi:U,latestStrapiReleaseTag:Q,strapiVersion:de}=O,{updateProjectSettings:q}=(0,ie.um)(),{allowedActions:{canRead:ye,canUpdate:H}}=(0,h.useRBAC)(Ye.Z.settings["project-settings"]),Fe=ye&&H,{data:Be}=(0,Ze.useQuery)("project-settings",un,{enabled:ye}),He=O.communityEdition?"app.components.UpgradePlanModal.text-ce":"app.components.UpgradePlanModal.text-ee",ot=(0,Ze.useMutation)(Et=>mn(Et),{async onSuccess({menuLogo:Et,authLogo:St}){await c.invalidateQueries("project-settings",{refetchActive:!0}),q({menuLogo:Et?.url,authLogo:St?.url})}}),lt=Et=>{if(Et.preventDefault(),!H)return;const St=g.current.getValues(),Tn=Pt(St);ot.mutate(Tn,{onSuccess(){const{menuLogo:bn,authLogo:_t}=St;bn.rawFile&&m("didChangeLogo",{logo:"menu"}),_t.rawFile&&m("didChangeLogo",{logo:"auth"}),d({type:"success",message:C({id:"app",defaultMessage:"Saved"})})},onError(){d({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred"}})}})};return e.createElement(ne.A,null,e.createElement(h.SettingsPageTitle,{name:"Application"}),e.createElement(X.o,null,e.createElement("form",{onSubmit:lt},e.createElement(Ie.T,{title:C({id:"Settings.application.title",defaultMessage:"Overview"}),subtitle:C({id:"Settings.application.description",defaultMessage:"Administration panel\u2019s global information"}),primaryAction:Fe&&e.createElement(k.z,{type:"submit",startIcon:e.createElement(B.Z,null)},C({id:"global.save",defaultMessage:"Save"}))}),e.createElement(tt.D,null,e.createElement(Ae.K,{spacing:6},e.createElement(Ae.K,{spacing:5,hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement($.Z,{variant:"delta",as:"h3"},C({id:"global.details",defaultMessage:"Details"})),e.createElement(b.r,{paddingTop:1},e.createElement(be.P,{col:6,s:12},e.createElement($.Z,{variant:"sigma",textColor:"neutral600"},C({id:"Settings.application.strapiVersion",defaultMessage:"strapi version"})),e.createElement($.Z,{as:"p"},"v",de),e.createElement(je.r,{href:O.communityEdition?"https://discord.strapi.io":"https://support.strapi.io/support/home",isExternal:!0,endIcon:e.createElement(ee.Z,null)},C({id:"Settings.application.get-help",defaultMessage:"Get help"}))),e.createElement(be.P,{col:6,s:12},e.createElement($.Z,{variant:"sigma",textColor:"neutral600"},C({id:"Settings.application.edition-title",defaultMessage:"current plan"})),e.createElement($.Z,{as:"p"},C({id:He,defaultMessage:`${O.communityEdition?"Community Edition":"Enterprise Edition"}`})))),e.createElement(b.r,{paddingTop:1},e.createElement(be.P,{col:6,s:12},U&&e.createElement(je.r,{href:`https://github.com/strapi/strapi/releases/tag/${Q}`,isExternal:!0,endIcon:e.createElement(ee.Z,null)},C({id:"Settings.application.link-upgrade",defaultMessage:"Upgrade your admin panel"}))),e.createElement(be.P,{col:6,s:12},e.createElement(je.r,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(ee.Z,null)},C({id:"Settings.application.link-pricing",defaultMessage:"See all pricing plans"})))),e.createElement(L.x,{paddingTop:1},e.createElement($.Z,{variant:"sigma",textColor:"neutral600"},C({id:"Settings.application.node-version",defaultMessage:"node version"})),e.createElement($.Z,{as:"p"},O.nodeVersion))),ye&&Be&&e.createElement(dn,{canUpdate:H,ref:g,projectSettingsStored:Be}))))))};var wt=t(94654),pn=t.n(wt);const gn=g=>pn()(g,m=>m.links).map(m=>(0,Pe.ot)(m.Component,m.to,m.exact||!1)),fn=g=>g.filter(d=>!d.links.every(m=>m.isDisplayed===!1));var It=t(42982),We=t(15861),hn=t(64687),V=t.n(hn),Kt=function(){return window&&window.strapi&&window.strapi.isEE?t(26789).Z:t(73871).Z}(),Vt=function(){return window&&window.strapi&&window.strapi.isEE?t(64527).Z:t(85302).Z}(),Ht=[{Component:function(){return{default:Vt}},to:"/settings/roles",exact:!0},{Component:function(){return{default:Kt}},to:"/settings/roles/duplicate/:id",exact:!0},{Component:function(){return{default:Kt}},to:"/settings/roles/new",exact:!0},{Component:function(){return(0,We.Z)(V().mark(function d(){var m;return V().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.e(2544).then(t.bind(t,92100));case 2:return m=c.sent,c.abrupt("return",m);case 4:case"end":return c.stop()}},d)}))()},to:"/settings/roles/:id",exact:!0},{Component:function(){return(0,We.Z)(V().mark(function d(){var m;return V().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.e(5199).then(t.bind(t,35097));case 2:return m=c.sent,c.abrupt("return",m);case 4:case"end":return c.stop()}},d)}))()},to:"/settings/users",exact:!0},{Component:function(){return(0,We.Z)(V().mark(function d(){var m;return V().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.e(4263).then(t.bind(t,22282));case 2:return m=c.sent,c.abrupt("return",m);case 4:case"end":return c.stop()}},d)}))()},to:"/settings/users/:id",exact:!0},{Component:function(){return(0,We.Z)(V().mark(function d(){var m;return V().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.e(5162).then(t.bind(t,3672));case 2:return m=c.sent,c.abrupt("return",m);case 4:case"end":return c.stop()}},d)}))()},to:"/settings/webhooks/create",exact:!0},{Component:function(){return(0,We.Z)(V().mark(function d(){var m;return V().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.e(5162).then(t.bind(t,9311));case 2:return m=c.sent,c.abrupt("return",m);case 4:case"end":return c.stop()}},d)}))()},to:"/settings/webhooks/:id",exact:!0},{Component:function(){return(0,We.Z)(V().mark(function d(){var m;return V().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.e(4121).then(t.bind(t,11199));case 2:return m=c.sent,c.abrupt("return",m);case 4:case"end":return c.stop()}},d)}))()},to:"/settings/webhooks",exact:!0},{Component:function(){return(0,We.Z)(V().mark(function d(){var m;return V().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.e(8056).then(t.bind(t,87427));case 2:return m=c.sent,c.abrupt("return",m);case 4:case"end":return c.stop()}},d)}))()},to:"/settings/api-tokens",exact:!0},{Component:function(){return(0,We.Z)(V().mark(function d(){var m;return V().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Promise.all([t.e(9761),t.e(4583),t.e(4299)]).then(t.bind(t,9683));case 2:return m=c.sent,c.abrupt("return",m);case 4:case"end":return c.stop()}},d)}))()},to:"/settings/api-tokens/create",exact:!0},{Component:function(){return(0,We.Z)(V().mark(function d(){var m;return V().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Promise.all([t.e(9761),t.e(4583),t.e(92)]).then(t.bind(t,28465));case 2:return m=c.sent,c.abrupt("return",m);case 4:case"end":return c.stop()}},d)}))()},to:"/settings/api-tokens/:id",exact:!0},{Component:function(){return(0,We.Z)(V().mark(function d(){var m;return V().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Promise.all([t.e(9761),t.e(3219),t.e(4816)]).then(t.bind(t,39987));case 2:return m=c.sent,c.abrupt("return",m);case 4:case"end":return c.stop()}},d)}))()},to:"/settings/transfer-tokens/create",exact:!0},{Component:function(){return(0,We.Z)(V().mark(function d(){var m;return V().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.e(9600).then(t.bind(t,70798));case 2:return m=c.sent,c.abrupt("return",m);case 4:case"end":return c.stop()}},d)}))()},to:"/settings/transfer-tokens",exact:!0},{Component:function(){return(0,We.Z)(V().mark(function d(){var m;return V().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Promise.all([t.e(9761),t.e(3219),t.e(2492)]).then(t.bind(t,9452));case 2:return m=c.sent,c.abrupt("return",m);case 4:case"end":return c.stop()}},d)}))()},to:"/settings/transfer-tokens/:id",exact:!0}];const Cn=Ht;var Ot=function(){return window&&window.strapi&&window.strapi.isEE?t(5420).Z:t(35301).Z}();const En=[].concat((0,It.Z)(Ot),(0,It.Z)(Cn));var vn=t(53192),Xt=t(38702),yn=t(34446),Sn=t(29489),Qt=t(73400);const Yt=({menu:g})=>{const{formatMessage:d}=(0,Y.useIntl)(),C=fn(g).map(O=>({...O,title:O.intlLabel,links:O.links.map(U=>({...U,title:U.intlLabel,name:U.id}))})),c=d({id:"global.settings",defaultMessage:"Settings"});return e.createElement(vn.m,{ariaLabel:c},e.createElement(Xt.p,{label:c}),e.createElement(yn.Z,null,C.map(O=>e.createElement(Sn.D,{key:O.id,label:d(O.intlLabel)},O.links.map(U=>e.createElement(Qt.E,{as:i.NavLink,withBullet:U.hasNotification,to:U.to,key:U.id},d(U.intlLabel)))))))};Yt.propTypes={menu:f().array.isRequired};const Ft=Yt;function Jt(){const{settingId:g}=(0,i.useParams)(),{settings:d}=(0,h.useStrapiApp)(),{formatMessage:m}=(0,Y.useIntl)(),{isLoading:C,menu:c}=(0,ie.Te)(),O=(0,e.useMemo)(()=>(0,Pe.WW)(En.map(({to:de,Component:q,exact:ye})=>(0,Pe.ot)(q,de,ye))),[]),U=gn(d);if(C)return e.createElement(h.LoadingIndicatorPage,null);if(!g)return e.createElement(i.Redirect,{to:"/settings/application-infos"});const Q=m({id:"global.settings",defaultMessage:"Settings"});return e.createElement(ne.A,{sideNav:e.createElement(Ft,{menu:c})},e.createElement(Qe.Helmet,{title:Q}),e.createElement(i.Switch,null,e.createElement(i.Route,{path:"/settings/application-infos",component:Gt,exact:!0}),O,U))}const qt=(0,e.memo)(Jt)},73871:(te,T,t)=>{t.d(T,{Z:()=>ne});var e=t(67294),h=t(49656);const ne=()=>e.createElement(h.Redirect,{to:"/404"})},79578:(te,T,t)=>{t.d(T,{Z:()=>h});const h=!0},56195:(te,T,t)=>{t.d(T,{Z:()=>h});const h=!0},35820:(te,T,t)=>{t.d(T,{Z:()=>h});const h=!0},53558:(te,T,t)=>{t.d(T,{Z:()=>h});const h=!0},99047:(te,T,t)=>{t.d(T,{Z:()=>h});const h=!0},28834:(te,T,t)=>{t.d(T,{Z:()=>Ro});var e=t(67294),h=t(45697),i=t.n(h),ne=t(68547),Y=t(82777),Qe=t(60633),ie=t(42761),Pe=t(18721),Ze=t.n(Pe),Ie=t(41609),tt=t.n(Ie),X=t(97132),L=t(41580),b=t(27821),be=t(89734),$=t.n(be),Ae=t(70885),k=t(66942),je=t(52337),ee=t(41451),B=t(11047),Ye=t(27361),w=t.n(Ye),f=t(57557),ze=t.n(f),le=t(48474),Ge=t(78114),we=t(29728);const ct=b.default.div`
  position: relative;

  ${({hasConditions:o,disabled:n,theme:a})=>o&&`
    &:before {
      content: '';
      position: absolute;
      top: -3px;
      left: -10px;
      width: 6px;
      height: 6px;
      border-radius: ${20/16}rem;;
      background: ${n?a.colors.neutral100:a.colors.primary600};
    }
  `}
`,nt=({onClick:o,className:n,hasConditions:a,variant:s})=>{const{formatMessage:l}=(0,X.useIntl)();return e.createElement(ct,{hasConditions:a,className:n},e.createElement(we.z,{variant:s,startIcon:e.createElement(Ge.Z,null),onClick:o},l({id:"global.settings",defaultMessage:"Settings"})))};nt.defaultProps={className:null,hasConditions:!1,variant:"tertiary"},nt.propTypes={onClick:i().func.isRequired,className:i().string,hasConditions:i().bool,variant:i().string};const Ke=(0,b.default)(nt)``;var at=t(42866),st=t(24969),it=t(59946),oe=t(36856),Je=t(2407),re=t(75515),x=t(18172),Ce=t(7739),N=t.n(Ce),Ee=t(11700),J=t.n(Ee),ae=t(38953);const Ue=o=>Object.values(o).map(n=>Object.entries(n).filter(([,a])=>a).map(([a])=>a)).flat(),Oe=o=>o.reduce((n,[a,s])=>(n.push({label:J()(a),children:s.map(l=>({label:l.displayName,value:l.id}))}),n),[]),ce=(o,n)=>o.map(([,a])=>a).flat().reduce((a,s)=>({[s.id]:n.includes(s.id),...a}),{});var Re=function(){return window&&window.strapi&&window.strapi.isEE?t(53273).Z:t(79578).Z}(),Ve=function(n){var a=n.arrayOfOptionsGroupedByCategory,s=n.isFormDisabled,l=n.isGrey,r=n.label,u=n.name,p=n.onChange,v=n.value,y=(0,X.useIntl)(),S=y.formatMessage,A=function(j){p(u,ce(a,j))};return e.createElement(B.k,{as:"li",background:l?"neutral100":"neutral0",paddingBottom:3,paddingTop:3},e.createElement(B.k,{paddingLeft:6,style:{width:180}},e.createElement(re.Z,{variant:"sigma",textColor:"neutral600"},S({id:"Settings.permissions.conditions.can",defaultMessage:"Can"}),"\xA0"),e.createElement(re.Z,{variant:"sigma",title:r,textColor:"primary600",ellipsis:!0},S({id:"Settings.roles.form.permissions.".concat(r.toLowerCase()),defaultMessage:r})),e.createElement(re.Z,{variant:"sigma",textColor:"neutral600"},"\xA0",S({id:"Settings.permissions.conditions.when",defaultMessage:"When"}))),e.createElement(L.x,{style:{maxWidth:430,width:"100%"}},e.createElement(ae.Q,{id:u,customizeContent:function(j){return"".concat(j.length," currently selected")},onChange:A,value:Ue(v),options:Oe(a),disabled:s||Re})))};Ve.propTypes={arrayOfOptionsGroupedByCategory:i().array.isRequired,isFormDisabled:i().bool.isRequired,isGrey:i().bool.isRequired,label:i().string.isRequired,name:i().string.isRequired,value:i().object.isRequired,onChange:i().func.isRequired};const qe=Ve;var E=t(96486);const _e=(o,n)=>o.reduce((a,s)=>(a[s.id]=(0,E.get)(n,s.id,!1),a),{}),R=(o,n)=>o.reduce((a,s)=>{const[l,r]=s,u=_e(r,n);return a[l]=u,a},{}),W=(o,n,a)=>o.reduce((s,l)=>{const r=(0,E.get)(n,[...l.pathToConditionsObject,"conditions"],{}),u=R(a,r);return s[l.pathToConditionsObject.join("..")]=u,s},{}),se=({actions:o,headerBreadCrumbs:n,isFormDisabled:a,onClosed:s,onToggle:l})=>{const{formatMessage:r}=(0,X.useIntl)(),{availableConditions:u,modifiedData:p,onChangeConditions:v}=(0,le.$_)(),y=(0,e.useMemo)(()=>Object.entries(N()(u,"category")),[u]),S=o.filter(({isDisplayed:D,hasSomeActionsSelected:F,hasAllActionsSelected:G})=>D&&(F||G)),A=(0,e.useMemo)(()=>W(S,p,y),[S,p,y]),[P,j]=(0,e.useState)(A),I=(D,F)=>{j((0,x.default)(G=>{G[D]||(G[D]={}),G[D].default||(G[D].default={}),G[D].default=F}))},z=()=>{const D=Object.entries(P).reduce((F,G)=>{const[ue,Xe]=G,Se=Object.values(Xe).reduce((fe,De)=>({...fe,...De}),{});return F[ue]=Se,F},{});v(D),l()};return e.createElement(at.P,{labelledBy:"condition-modal-breadcrumbs",onClose:s},e.createElement(st.x,null,e.createElement(Je.O,{id:"condition-modal-breadcrumbs",label:n.join(", ")},n.map(D=>e.createElement(Je.$,{key:D},J()(r({id:D,defaultMessage:D})))))),e.createElement(it.f,null,S.length===0&&e.createElement(re.Z,null,r({id:"Settings.permissions.conditions.no-actions",defaultMessage:"You first need to select actions (create, read, update, ...) before defining conditions on them."})),e.createElement("ul",null,S.map(({actionId:D,label:F,pathToConditionsObject:G},ue)=>{const Xe=G.join("..");return e.createElement(qe,{key:D,arrayOfOptionsGroupedByCategory:y,label:F,isFormDisabled:a,isGrey:ue%2===0,name:Xe,onChange:I,value:w()(P,Xe,{})})}))),e.createElement(oe.m,{startActions:e.createElement(we.z,{variant:"tertiary",onClick:l},r({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(we.z,{onClick:z},r({id:"Settings.permissions.conditions.apply",defaultMessage:"Apply"}))}))};se.propTypes={actions:i().arrayOf(i().shape({actionId:i().string.isRequired,checkboxName:i().string,hasSomeActionsSelected:i().bool.isRequired,hasAllActionsSelected:i().bool,isDisplayed:i().bool.isRequired,label:i().string})).isRequired,headerBreadCrumbs:i().arrayOf(i().string).isRequired,isFormDisabled:i().bool.isRequired,onClosed:i().func.isRequired,onToggle:i().func.isRequired};const K=se,pe=`${120/16}rem`,Me=`${200/16}rem`,$e=`${53/16}rem`,M=b.default.div`
  width: ${pe};
`,ut=(0,b.default)(B.k)`
  padding-right: ${({theme:o})=>o.spaces[2]};
  overflow: hidden;
  flex: 1;
  ${({isCollapsable:o})=>o&&"cursor: pointer;"}
`,At=({children:o,isCollapsable:n,isActive:a,isFormDisabled:s,label:l,onChange:r,onClick:u,checkboxName:p,someChecked:v,value:y})=>{const{formatMessage:S}=(0,X.useIntl)();return e.createElement(B.k,{alignItems:"center",paddingLeft:6,style:{width:Me,flexShrink:0}},e.createElement(L.x,{paddingRight:2},e.createElement(ee.C,{name:p,"aria-label":S({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:l}),disabled:s,onValueChange:A=>r({target:{name:p,value:A}}),indeterminate:v,value:y})),e.createElement(ut,{title:l,alignItems:"center",isCollapsable:n,...n&&{onClick:u,"aria-expanded":a,onKeyDown:({key:A})=>(A==="Enter"||A===" ")&&u(),tabIndex:0,role:"button"}},e.createElement(re.Z,{fontWeight:a?"bold":"",textColor:a?"primary600":"neutral800",ellipsis:!0},J()(l)),o))};At.defaultProps={children:null,checkboxName:"",onChange(){},value:!1,someChecked:!1,isCollapsable:!1},At.propTypes={checkboxName:i().string,children:i().node,label:i().string.isRequired,isCollapsable:i().bool,isFormDisabled:i().bool.isRequired,onChange:i().func,onClick:i().func.isRequired,someChecked:i().bool,value:i().bool,isActive:i().bool.isRequired};const Nt=(0,e.memo)(At),Zt=o=>(0,E.isObject)(o)?(0,E.flattenDeep)(Object.values(o).map(n=>(0,E.isObject)(n)?Zt(n):n)):[],ft=Zt,ht=o=>o?Object.keys(o).reduce((n,a)=>(a!=="conditions"&&(n[a]=o[a]),n),{}):null,et=o=>{const n=ht(o),a=ft(n);if(!a.length)return{hasAllActionsSelected:!1,hasSomeActionsSelected:!1};const s=a.every(r=>r),l=a.some(r=>r)&&!s;return{hasAllActionsSelected:s,hasSomeActionsSelected:l}},tn=(o,n,a)=>o.map(({actionId:s,isDisplayed:l,applyToProperties:r,label:u})=>{if(!l)return{actionId:s,hasSomeActionsSelected:!1,isDisplayed:l};const p=[...a.split(".."),s],v=(0,E.isEmpty)(r)?[...p,"properties","enabled"]:p,y=v.join(".."),S=(0,E.get)(n,[...p,"conditions"],null),A=ft(S).some(z=>z);if((0,E.isEmpty)(r)){const z=(0,E.get)(n,v,!1);return{actionId:s,checkboxName:y,hasAllActionsSelected:z,hasConditions:A,hasSomeActionsSelected:z,isDisplayed:l,isParentCheckbox:!1,label:u,pathToConditionsObject:p}}const P=(0,E.get)(n,v,null),{hasAllActionsSelected:j,hasSomeActionsSelected:I}=et(P);return{actionId:s,checkboxName:y,hasAllActionsSelected:j,hasConditions:A,hasSomeActionsSelected:I,isDisplayed:l,isParentCheckbox:!0,label:u,pathToConditionsObject:p}});var nn=t(12645);const Ct=(0,b.default)(nn.default)`
  display: none;
  width: ${10/16}rem;
  transform: rotate(${({$isActive:o})=>o?"180":"0"}deg);
  margin-left: ${({theme:o})=>o.spaces[2]};
`,mt=o=>`
  ${re.Z} {
    color: ${o.colors.primary600};
    font-weight: ${o.fontWeights.bold}
  }
  ${Ct} {
    display: block;
    path {
      fill: ${o.colors.primary600}
    };
  }
`;var jt=function(){return window&&window.strapi&&window.strapi.isEE?t(20591).Z:t(56195).Z}(),Rt=function o(n,a){return`
  `.concat(zt,` {
    background-color: `).concat(n.colors.primary100,`;
    color: `).concat(n.colors.primary600,`;
    border-radius: `).concat(a?"2px 2px 0 0":"2px",`;
  }
  `).concat(an,` {
    display: flex;
  }
  `).concat(Ke,` {
    display: block;
  }
  &:hover {
   `).concat(mt(n),`
  }

  &:focus-within {
    `).concat(function(s){var l=s.theme,r=s.isActive;return o(l,r)},`
  }
  
`)},zt=b.default.div.withConfig({displayName:"Collapse__Wrapper",componentId:"sc-132fji1-0"})(["flex:1;display:flex;align-items:center;height:",";background-color:",";border:1px solid transparent;"],$e,function(o){var n=o.isGrey,a=o.theme;return n?a.colors.neutral100:a.colors.neutral0}),Mt=b.default.div.withConfig({displayName:"Collapse__BoxWrapper",componentId:"sc-132fji1-1"})(["display:inline-flex;min-width:100%;","{display:none;}"," &:hover{","}"],Ke,function(o){var n=o.isActive,a=o.theme;return n&&Rt(a,n)},function(o){var n=o.theme,a=o.isActive;return Rt(n,a)}),on=(0,b.default)(B.k).withConfig({displayName:"Collapse__Cell",componentId:"sc-132fji1-2"})(["width:",";position:relative;"],pe),an=(0,b.default)(L.x).withConfig({displayName:"Collapse__Chevron",componentId:"sc-132fji1-3"})(["display:none;svg{width:11px;}*{fill:",";}"],function(o){var n=o.theme;return n.colors.primary600}),Ut=b.default.span.withConfig({displayName:"Collapse__TinyDot",componentId:"sc-132fji1-4"})(["position:absolute;top:-6px;left:37px;width:6px;height:6px;border-radius:20px;background:",";"],function(o){var n=o.theme;return n.colors.primary600}),Dt=(0,b.default)(L.x).withConfig({displayName:"Collapse__AbsoluteBox",componentId:"sc-132fji1-5"})(["position:absolute;right:9px;transform:translateY(10px);"]),Lt=function(n){var a=n.availableActions,s=n.isActive,l=n.isGrey,r=n.isFormDisabled,u=n.label,p=n.onClickToggle,v=n.pathToData,y=(0,e.useState)(!1),S=(0,Ae.Z)(y,2),A=S[0],P=S[1],j=(0,X.useIntl)(),I=j.formatMessage,z=(0,le.$_)(),D=z.modifiedData,F=z.onChangeParentCheckbox,G=z.onChangeSimpleCheckbox,ue=function(){P(function(ge){return!ge})},Xe=function(){P(!1)},Se=w()(D,v.split(".."),{}),fe=(0,e.useMemo)(function(){return Object.keys(Se).reduce(function(_,ge){return _[ge]=ze()(Se[ge],"conditions"),_},{})},[Se]),De=et(fe),Te=De.hasAllActionsSelected,vt=De.hasSomeActionsSelected,me=(0,e.useMemo)(function(){return tn(a,D,v)},[a,D,v]),Le=me.some(function(_){var ge=_.hasConditions;return ge});return e.createElement(Mt,{isActive:s},e.createElement(zt,{isGrey:l},e.createElement(Nt,{isCollapsable:!0,isFormDisabled:r,label:u,checkboxName:v,onChange:F,onClick:p,someChecked:vt,value:Te,isActive:s},e.createElement(an,{paddingLeft:2},s?e.createElement(je.Z,null):e.createElement(k.Z,null))),e.createElement(B.k,{style:{flex:1}},me.map(function(_){var ge=_.actionId,he=_.hasConditions,xe=_.hasAllActionsSelected,Ne=_.hasSomeActionsSelected,gt=_.isDisplayed,ke=_.isParentCheckbox,rt=_.checkboxName,Tt=_.label;return gt?ke?e.createElement(on,{key:ge,justifyContent:"center",alignItems:"center"},he&&e.createElement(Ut,null),e.createElement(ee.C,{disabled:r||jt,name:rt,"aria-label":I({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(Tt," ").concat(u)}),onValueChange:function(yt){F({target:{name:rt,value:yt}})},indeterminate:Ne,value:xe})):e.createElement(on,{key:ge,justifyContent:"center",alignItems:"center"},he&&e.createElement(Ut,null),e.createElement(ee.C,{disabled:r||jt,indeterminate:he,name:rt,onValueChange:function(yt){G({target:{name:rt,value:yt}})},value:xe})):e.createElement(M,{key:ge})})),A&&e.createElement(K,{headerBreadCrumbs:[u,"Settings.permissions.conditions.conditions"],actions:me,isFormDisabled:r,onClosed:Xe,onToggle:ue})),e.createElement(Dt,null,e.createElement(Ke,{onClick:ue,hasConditions:Le})))};Lt.propTypes={availableActions:i().array.isRequired,isActive:i().bool.isRequired,isGrey:i().bool.isRequired,isFormDisabled:i().bool.isRequired,label:i().string.isRequired,onClickToggle:i().func.isRequired,pathToData:i().string.isRequired};const xt=Lt,sn=(o,n)=>o.map(a=>{const s=Array.isArray(a.applyToProperties)&&a.applyToProperties.indexOf(n)!==-1&&a.isDisplayed;return{label:a.label,actionId:a.actionId,isActionRelatedToCurrentProperty:s}}),$t=(0,b.default)(B.k)`
  width: ${pe};
  flex-shrink: 0;
`,ln=(0,b.default)(B.k)`
  width: ${Me};
  height: ${$e};
  flex-shrink: 0;
`,rn=({headers:o,label:n})=>{const{formatMessage:a}=(0,X.useIntl)(),s=a({id:"Settings.roles.form.permission.property-label",defaultMessage:"{label} permissions"},{label:n});return e.createElement(B.k,null,e.createElement(ln,{alignItems:"center",paddingLeft:6},e.createElement(re.Z,{variant:"sigma",textColor:"neutral500"},s)),o.map(l=>l.isActionRelatedToCurrentProperty?e.createElement($t,{justifyContent:"center",key:l.label},e.createElement(re.Z,{variant:"sigma",textColor:"neutral500"},a({id:`Settings.roles.form.permissions.${l.label.toLowerCase()}`,defaultMessage:l.label}))):e.createElement($t,{key:l.label})))};rn.propTypes={headers:i().arrayOf(i().shape({label:i().string.isRequired,isActionRelatedToCurrentProperty:i().bool.isRequired})).isRequired,label:i().string.isRequired};const cn=rn;var pt=t(42982);const dn=b.default.span`
  color: ${({theme:o})=>o.colors.danger700};
  padding-left: ${({theme:o})=>o.spaces[1]}px;
`,Wt=()=>e.createElement(dn,null,"*"),kt=(o,n)=>o.map(a=>{const s=Array.isArray(a.subjects)&&a.subjects.indexOf(n)!==-1;return{...a,isDisplayed:s}});var un=t(87462);const mn=(0,b.default)(L.x)`
  transform: translate(-4px, -12px);

  &:before {
    content: '';
    width: ${4/16}rem;
    height: ${12/16}rem;
    background: ${({theme:o})=>o.colors.primary200};
    display: block;
  }
`,jn=b.default.svg`
  position: relative;
  flex-shrink: 0;
  transform: translate(-0.5px, -1px);

  * {
    fill: ${({theme:o,color:n})=>o.colors[n]};
  }
`,Pt=o=>e.createElement(mn,null,e.createElement(jn,{width:"20",height:"23",viewBox:"0 0 20 23",fill:"none",xmlns:"http://www.w3.org/2000/svg",...o},e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.02477 14.7513C8.65865 17.0594 11.6046 18.6059 17.5596 18.8856C18.6836 18.9384 19.5976 19.8435 19.5976 20.9688V20.9688C19.5976 22.0941 18.6841 23.0125 17.5599 22.9643C10.9409 22.6805 6.454 20.9387 3.75496 17.1258C0.937988 13.1464 0.486328 7.39309 0.486328 0.593262H4.50974C4.50974 7.54693 5.06394 11.9813 7.02477 14.7513Z",fill:"#D9D8FF"})));Pt.defaultProps={fill:"primary200"},Pt.propTypes={fill:i().string};const zn=(0,e.memo)(Pt);var Gt=function(){return window&&window.strapi&&window.strapi.isEE?t(76766).Z:t(53558).Z}(),wt=(0,b.default)(B.k).withConfig({displayName:"SubActionRow__Cell",componentId:"sc-7y8yzq-0"})(["width:",";position:relative;"],pe),pn=(0,b.default)(B.k).withConfig({displayName:"SubActionRow__RowWrapper",componentId:"sc-7y8yzq-1"})(["height:",";"],$e),Un=(0,b.default)(L.x).withConfig({displayName:"SubActionRow__Wrapper",componentId:"sc-7y8yzq-2"})(["padding-left:","rem;"],31/16),gn=(0,b.default)(L.x).withConfig({displayName:"SubActionRow__LeftBorderTimeline",componentId:"sc-7y8yzq-3"})(["border-left:",";"],function(o){var n=o.isVisible,a=o.theme;return n?"4px solid ".concat(a.colors.primary200):"4px solid transparent"}),$n=(0,b.default)(B.k).withConfig({displayName:"SubActionRow__RowStyle",componentId:"sc-7y8yzq-4"})(["padding-left:",";width:","px;"," ",";"],function(o){var n=o.theme;return n.spaces[4]},function(o){var n=o.level;return 145-n*36},function(o){var n=o.isCollapsable,a=o.theme;return n&&`
      `.concat(Ct,` {
        display: block;
        color: `).concat(a.colors.neutral100,`;
      }
      &:hover {
        `).concat(mt(a),`
      }
  `)},function(o){var n=o.isActive,a=o.theme;return n&&mt(a)}),fn=b.default.div.withConfig({displayName:"SubActionRow__TopTimeline",componentId:"sc-7y8yzq-5"})(["padding-top:",";margin-top:",";width:","rem;background-color:",";border-top-left-radius:2px;border-top-right-radius:2px;"],function(o){var n=o.theme;return n.spaces[2]},function(o){var n=o.theme;return n.spaces[2]},4/16,function(o){var n=o.theme;return n.colors.primary200}),It=function o(n){var a=n.childrenForm,s=n.isFormDisabled,l=n.recursiveLevel,r=n.pathToDataFromActionRow,u=n.propertyActions,p=n.parentName,v=n.propertyName,y=(0,X.useIntl)(),S=y.formatMessage,A=(0,le.$_)(),P=A.modifiedData,j=A.onChangeParentCheckbox,I=A.onChangeSimpleCheckbox,z=(0,e.useState)(null),D=(0,Ae.Z)(z,2),F=D[0],G=D[1],ue=function(fe){G(function(De){return De===fe?null:fe})},Xe=(0,e.useMemo)(function(){return F?a.find(function(Se){var fe=Se.value;return fe===F}):null},[F,a]);return e.createElement(Un,null,e.createElement(fn,null),a.map(function(Se,fe){var De=Se.label,Te=Se.value,vt=Se.required,me=Se.children,Le=fe+1<a.length,_=Array.isArray(me),ge=F===Te;return e.createElement(gn,{key:Te,isVisible:Le},e.createElement(pn,null,e.createElement(zn,{color:"primary200"}),e.createElement(B.k,{style:{flex:1}},e.createElement($n,{level:l,isActive:ge,isCollapsable:_},e.createElement(ut,(0,un.Z)({alignItems:"center",isCollapsable:_},_&&{onClick:function(){return ue(Te)},"aria-expanded":ge,onKeyDown:function(xe){var Ne=xe.key;return(Ne==="Enter"||Ne===" ")&&ue(Te)},tabIndex:0,role:"button"},{title:De}),e.createElement(re.Z,{ellipsis:!0},J()(De)),vt&&e.createElement(Wt,null),e.createElement(Ct,{$isActive:ge}))),e.createElement(B.k,{style:{flex:1}},u.map(function(he){var xe=he.actionId,Ne=he.label,gt=he.isActionRelatedToCurrentProperty;if(!gt)return e.createElement(M,{key:xe});var ke=[].concat((0,pt.Z)(r.split("..")),[xe,"properties",v],(0,pt.Z)(p.split("..")),[Te]),rt=w()(P,ke,!1);if(!me)return e.createElement(wt,{key:Ne,justifyContent:"center",alignItems:"center"},e.createElement(ee.C,{disabled:s||Gt,name:ke.join(".."),"aria-label":S({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(p," ").concat(De," ").concat(Ne)}),onValueChange:function(Bt){I({target:{name:ke.join(".."),value:Bt}})},value:rt}));var Tt=et(rt),bt=Tt.hasAllActionsSelected,yt=Tt.hasSomeActionsSelected;return e.createElement(wt,{key:Ne,justifyContent:"center",alignItems:"center"},e.createElement(ee.C,{key:Ne,disabled:s||Gt,name:ke.join(".."),"aria-label":S({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(p," ").concat(De," ").concat(Ne)}),onValueChange:function(Bt){j({target:{name:ke.join(".."),value:Bt}})},value:bt,indeterminate:yt}))})))),Xe&&ge&&e.createElement(L.x,{paddingBottom:2},e.createElement(o,{isFormDisabled:s,parentName:"".concat(p,"..").concat(Te),pathToDataFromActionRow:r,propertyActions:u,propertyName:v,recursiveLevel:l+1,childrenForm:Xe.children})))}))};It.propTypes={childrenForm:i().array.isRequired,isFormDisabled:i().bool.isRequired,parentName:i().string.isRequired,pathToDataFromActionRow:i().string.isRequired,propertyActions:i().array.isRequired,propertyName:i().string.isRequired,recursiveLevel:i().number.isRequired};const We=(0,e.memo)(It),hn=o=>o.reduce((a,s)=>(s.isActionRelatedToCurrentProperty&&a.push(s.actionId),a),[]),Kt=(o,n,a,s,l)=>{const u=hn(o).reduce((p,v)=>{const y=[...a.split(".."),v,"properties",s,l],S=(0,E.get)(n,y,!1);return p[v]=S,p},{});return et(u)};var Vt=function(){return window&&window.strapi&&window.strapi.isEE?t(74512).Z:t(35820).Z}(),Ht=(0,b.default)(B.k).withConfig({displayName:"ActionRow__Cell",componentId:"sc-4agenc-0"})(["width:",";position:relative;"],pe),Cn=(0,b.default)(B.k).withConfig({displayName:"ActionRow__Wrapper",componentId:"sc-4agenc-1"})(["height:",";flex:1;"," ",";"],$e,function(o){var n=o.isCollapsable,a=o.theme;return n&&`
      `.concat(Ct,` {
        display: block;
        color: `).concat(a.colors.neutral100,`;
      }
      &:hover {
        `).concat(mt(a),`
      }
  `)},function(o){var n=o.isActive,a=o.theme;return n&&mt(a)}),Ot=function(n){var a=n.childrenForm,s=n.label,l=n.isFormDisabled,r=n.name,u=n.required,p=n.pathToData,v=n.propertyActions,y=n.propertyName,S=n.isOdd,A=(0,X.useIntl)(),P=A.formatMessage,j=(0,e.useState)(null),I=(0,Ae.Z)(j,2),z=I[0],D=I[1],F=(0,le.$_)(),G=F.modifiedData,ue=F.onChangeCollectionTypeLeftActionRowCheckbox,Xe=F.onChangeParentCheckbox,Se=F.onChangeSimpleCheckbox,fe=z===r,De=(0,e.useMemo)(function(){return Array.isArray(a)?a:[]},[a]),Te=De.length>0,vt=(0,e.useCallback)(function(){Te&&D(function(he){return he===r?null:r})},[Te,r]),me=function(xe){var Ne=xe.target.value;ue(p,y,r,Ne)},Le=(0,e.useMemo)(function(){return Kt(v,G,p,y,r)},[v,G,p,y,r]),_=Le.hasAllActionsSelected,ge=Le.hasSomeActionsSelected;return e.createElement(e.Fragment,null,e.createElement(Cn,{alignItems:"center",isCollapsable:Te,isActive:fe,background:S?"neutral100":"neutral0"},e.createElement(B.k,null,e.createElement(Nt,{onChange:me,onClick:vt,isCollapsable:Te,isFormDisabled:l,label:s,someChecked:ge,value:_,isActive:fe},u&&e.createElement(Wt,null),e.createElement(Ct,{$isActive:fe})),e.createElement(B.k,null,v.map(function(he){var xe=he.label,Ne=he.isActionRelatedToCurrentProperty,gt=he.actionId;if(!Ne)return e.createElement(M,{key:xe});var ke=[].concat((0,pt.Z)(p.split("..")),[gt,"properties",y,r]);if(!Te){var rt=w()(G,ke,!1);return e.createElement(Ht,{key:gt,justifyContent:"center",alignItems:"center"},e.createElement(ee.C,{disabled:l||Vt,name:ke.join(".."),"aria-label":P({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(r," ").concat(xe)}),onValueChange:function(Pn){Se({target:{name:ke.join(".."),value:Pn}})},value:rt}))}var Tt=w()(G,ke,{}),bt=et(Tt),yt=bt.hasAllActionsSelected,xn=bt.hasSomeActionsSelected;return e.createElement(Ht,{key:xe,justifyContent:"center",alignItems:"center"},e.createElement(ee.C,{disabled:l||Vt,name:ke.join(".."),onValueChange:function(Pn){Xe({target:{name:ke.join(".."),value:Pn}})},"aria-label":P({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(r," ").concat(xe)}),value:yt,indeterminate:xn}))})))),fe&&e.createElement(We,{childrenForm:De,isFormDisabled:l,parentName:r,pathToDataFromActionRow:p,propertyName:y,propertyActions:v,recursiveLevel:0}))};Ot.defaultProps={childrenForm:[],required:!1},Ot.propTypes={childrenForm:i().array,label:i().string.isRequired,isFormDisabled:i().bool.isRequired,name:i().string.isRequired,pathToData:i().string.isRequired,propertyActions:i().array.isRequired,propertyName:i().string.isRequired,required:i().bool,isOdd:i().bool.isRequired};const En=(0,e.memo)(Ot),vn=b.default.div`
  display: inline-flex;
  flex-direction: column;
  min-width: 0;
`,Xt=({availableActions:o,childrenForm:n,isFormDisabled:a,label:s,pathToData:l,propertyName:r})=>{const u=(0,e.useMemo)(()=>sn(o,r),[o,r]);return e.createElement(vn,null,e.createElement(cn,{label:s,headers:u}),e.createElement(L.x,null,n.map(({children:p,label:v,value:y,required:S},A)=>e.createElement(En,{childrenForm:p,key:y,label:v,isFormDisabled:a,name:y,required:S,propertyActions:u,pathToData:l,propertyName:r,isOdd:A%2===0}))))};Xt.propTypes={childrenForm:i().array.isRequired,availableActions:i().array.isRequired,isFormDisabled:i().bool.isRequired,label:i().string.isRequired,pathToData:i().string.isRequired,propertyName:i().string.isRequired};const yn=Xt,Sn=b.default.div`
  flex-direction: column;
  display: inline-flex;
  min-width: 100%;
  ${({theme:o,isActive:n})=>n&&`border: 1px solid ${o.colors.primary600};`}
`,Qt=({allActions:o,contentTypeName:n,label:a,index:s,isActive:l,isFormDisabled:r,onClickToggleCollapse:u,pathToData:p,properties:v})=>{const y=(0,e.useCallback)(()=>{u(n)},[n,u]),S=(0,e.useMemo)(()=>kt(o,n),[o,n]);return e.createElement(Sn,{isActive:l},e.createElement(xt,{availableActions:S,isActive:l,isGrey:s%2===0,isFormDisabled:r,label:a,onClickToggle:y,pathToData:p}),l&&v.map(({label:A,value:P,children:j})=>e.createElement(yn,{availableActions:S,childrenForm:j,isFormDisabled:r,label:A,pathToData:p,propertyName:P,key:P})))};Qt.propTypes={allActions:i().array.isRequired,contentTypeName:i().string.isRequired,index:i().number.isRequired,isActive:i().bool.isRequired,isFormDisabled:i().bool.isRequired,label:i().string.isRequired,onClickToggleCollapse:i().func.isRequired,pathToData:i().string.isRequired,properties:i().array.isRequired};const Yt=Qt,Ft=({actions:o,isFormDisabled:n,pathToData:a,subjects:s})=>{const[l,r]=(0,e.useState)(null),u=p=>{r(l===p?null:p)};return s.map(({uid:p,label:v,properties:y},S)=>e.createElement(Yt,{allActions:o,key:p,contentTypeName:p,label:v,isActive:l===p,isFormDisabled:n,index:S,onClickToggleCollapse:u,pathToData:`${a}..${p}`,properties:y}))};Ft.defaultProps={actions:[],subjects:[]},Ft.propTypes={actions:i().array.isRequired,isFormDisabled:i().bool.isRequired,pathToData:i().string.isRequired,subjects:i().arrayOf(i().shape({uid:i().string.isRequired,label:i().string.isRequired,properties:i().array.isRequired}))};const Jt=(0,e.memo)(Ft);var qt=t(7681);const d=o=>o.filter(({subjects:n})=>n&&n.length),m=o=>o.map(({actionId:n})=>n),C=(o,n)=>o.reduce((a,s)=>(Object.keys(n).forEach(l=>{const r=(0,E.get)(n,[l,s],{}),u={[l]:ht(r)};a[s]?a[s]={...a[s],...u}:a[s]=u}),a),{}),O=(o,n)=>{const a=m(o),s=C(a,n);return Object.keys(s).reduce((r,u)=>(r[u]=et(s[u]),r),{})};var U=function(){return window&&window.strapi&&window.strapi.isEE?t(85822).Z:t(99047).Z}(),Q=(0,b.default)(qt.K).withConfig({displayName:"GlobalActions__CenteredStack",componentId:"sc-1vxwsjr-0"})(["align-items:center;justify-content:center;width:",";flex-shrink:0;"],pe),de=function(n){var a=n.actions,s=n.isFormDisabled,l=n.kind,r=(0,X.useIntl)(),u=r.formatMessage,p=(0,le.$_)(),v=p.modifiedData,y=p.onChangeCollectionTypeGlobalActionCheckbox,S=(0,e.useMemo)(function(){return d(a)},[a]),A=(0,e.useMemo)(function(){return O(S,v[l])},[v,S,l]);return e.createElement(L.x,{paddingBottom:4,paddingTop:6,style:{paddingLeft:Me}},e.createElement(qt.K,{horizontal:!0,spacing:0},S.map(function(P){var j=P.label,I=P.actionId;return e.createElement(Q,{key:I,spacing:3},e.createElement(re.Z,{variant:"sigma",textColor:"neutral500"},u({id:"Settings.roles.form.permissions.".concat(j.toLowerCase()),defaultMessage:j})),e.createElement(ee.C,{disabled:s||U,onValueChange:function(D){y(l,I,D)},name:I,"aria-label":u({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:u({id:"Settings.roles.form.permissions.".concat(j.toLowerCase()),defaultMessage:j})}),value:w()(A,[I,"hasAllActionsSelected"],!1),indeterminate:w()(A,[I,"hasSomeActionsSelected"],!1)}))})))};de.defaultProps={actions:[]},de.propTypes={actions:i().arrayOf(i().shape({label:i().string.isRequired,actionId:i().string.isRequired,subjects:i().array.isRequired})),isFormDisabled:i().bool.isRequired,kind:i().string.isRequired};const q=(0,e.memo)(de),ye=(0,b.default)(L.x)`
  overflow-x: auto;
`,H=({isFormDisabled:o,kind:n,layout:{actions:a,subjects:s}})=>{const l=$()([...s],"label");return e.createElement(ye,{background:"neutral0"},e.createElement(q,{actions:a,kind:n,isFormDisabled:o}),e.createElement(Jt,{actions:a,isFormDisabled:o,pathToData:n,subjects:l}))};H.propTypes={isFormDisabled:i().bool.isRequired,kind:i().string.isRequired,layout:i().shape({actions:i().array,subjects:i().arrayOf(i().shape({uid:i().string.isRequired,label:i().string.isRequired,properties:i().array.isRequired}))}).isRequired};const Fe=(0,e.memo)(H);var Be=t(47713);const He=({children:o,value:n})=>e.createElement(Be.$l.Provider,{value:n},o);He.propTypes={children:i().node.isRequired,value:i().exact({availableConditions:i().array.isRequired,modifiedData:i().object.isRequired,onChangeCollectionTypeLeftActionRowCheckbox:i().func.isRequired,onChangeConditions:i().func.isRequired,onChangeSimpleCheckbox:i().func.isRequired,onChangeParentCheckbox:i().func.isRequired,onChangeCollectionTypeGlobalActionCheckbox:i().func.isRequired}).isRequired};const ot=He;var lt=t(48734),Et=t(74756),St=t(63081),Tn=t(11276),bn=t(74571),_t=t(36213);const ao=(o,n,a)=>o.map(s=>{const l=[...a,s.action,"properties","enabled"],r=(0,E.get)(n,l,!1),u=(0,E.get)(n,[...a,s.action,"conditions"],{}),p=ft(u).some(v=>v);return{...s,isDisplayed:r,checkboxName:l.join(".."),hasSomeActionsSelected:r,value:r,hasConditions:p,label:s.displayName,actionId:s.action,pathToConditionsObject:[...a,s.action]}}),so=o=>{const n=Object.entries(o).reduce((s,l)=>{const[r,{conditions:u}]=l;return s[r]=u,s},{});return ft(n).some(s=>s)};var An=function(){return window&&window.strapi&&window.strapi.isEE?t(8629).Z:t(34341).Z}(),io=b.default.div.withConfig({displayName:"SubCategory__Border",componentId:"sc-akgczm-0"})(["flex:1;align-self:center;border-top:1px solid ",";"],function(o){var n=o.theme;return n.colors.neutral150}),lo=b.default.div.withConfig({displayName:"SubCategory__CheckboxWrapper",componentId:"sc-akgczm-1"})(["position:relative;word-break:keep-all;",""],function(o){var n=o.hasConditions,a=o.disabled,s=o.theme;return n&&`
    &:before {
      content: '';
      position: absolute;
      top: `.concat(-4/16,`rem;
      left: `).concat(-8/16,`rem;
      width: `).concat(6/16,`rem;
      height: `).concat(6/16,`rem;
      border-radius: `).concat(20/16,`rem;
      background: `).concat(a?s.colors.neutral100:s.colors.primary600,`;
    }
  `)}),Wn=function(n){var a=n.categoryName,s=n.isFormDisabled,l=n.subCategoryName,r=n.actions,u=n.pathToData,p=(0,e.useState)(!1),v=(0,Ae.Z)(p,2),y=v[0],S=v[1],A=(0,le.$_)(),P=A.modifiedData,j=A.onChangeParentCheckbox,I=A.onChangeSimpleCheckbox,z=(0,X.useIntl)(),D=z.formatMessage,F=w()(P,u,{}),G=(0,e.useMemo)(function(){return Object.keys(F).reduce(function(me,Le){return me[Le]=ht(F[Le]),me},{})},[F]),ue=et(G),Xe=ue.hasAllActionsSelected,Se=ue.hasSomeActionsSelected,fe=function(){S(function(Le){return!Le})},De=function(){S(!1)},Te=ao(r,P,u),vt=so(w()(P,(0,pt.Z)(u),{}));return e.createElement(e.Fragment,null,e.createElement(L.x,null,e.createElement(B.k,{justifyContent:"space-between",alignItems:"center"},e.createElement(L.x,{paddingRight:4},e.createElement(re.Z,{variant:"sigma",textColor:"neutral600"},l)),e.createElement(io,null),e.createElement(L.x,{paddingLeft:4},e.createElement(_t.X,{name:u.join(".."),disabled:s||An,onValueChange:function(Le){j({target:{name:u.join(".."),value:Le}})},indeterminate:Se,value:Xe},D({id:"app.utils.select-all",defaultMessage:"Select all"})))),e.createElement(B.k,{paddingTop:6,paddingBottom:6},e.createElement(Tn.r,{gap:2,style:{flex:1}},Te.map(function(me){var Le=me.checkboxName,_=me.value,ge=me.action,he=me.displayName,xe=me.hasConditions;return e.createElement(bn.P,{col:3,key:ge},e.createElement(lo,{disabled:s||An,hasConditions:xe},e.createElement(_t.X,{name:Le,disabled:s||An,onValueChange:function(gt){I({target:{name:Le,value:gt}})},value:_},he)))})),e.createElement(Ke,{hasConditions:vt,onClick:fe}))),y&&e.createElement(K,{headerBreadCrumbs:[a,l],actions:Te,isFormDisabled:s,onClosed:De,onToggle:fe}))};Wn.propTypes={actions:i().array.isRequired,categoryName:i().string.isRequired,isFormDisabled:i().bool.isRequired,subCategoryName:i().string.isRequired,pathToData:i().array.isRequired};const ro=Wn,Rn=({childrenForm:o,kind:n,name:a,isOpen:s,isFormDisabled:l,isWhite:r,onOpenCategory:u,pathToData:p})=>{const{formatMessage:v}=(0,X.useIntl)(),y=()=>{u(a)},S=(0,e.useMemo)(()=>a.split("::").pop(),[a]);return e.createElement(lt.U,{expanded:s,onToggle:y,id:`accordion-${a}`,variant:r?"primary":"secondary"},e.createElement(Et.B,{title:J()(S),description:`${v({id:"Settings.permissions.category"},{category:S})} ${n==="plugins"?"plugin":n}`}),e.createElement(St.v,null,e.createElement(L.x,{padding:6},o.map(({actions:A,subCategoryName:P,subCategoryId:j})=>e.createElement(ro,{key:P,actions:A,categoryName:S,isFormDisabled:l,subCategoryName:P,pathToData:[...p,j]})))))};Rn.defaultProps={},Rn.propTypes={childrenForm:i().array.isRequired,isOpen:i().bool.isRequired,isFormDisabled:i().bool.isRequired,isWhite:i().bool.isRequired,kind:i().string.isRequired,name:i().string.isRequired,onOpenCategory:i().func.isRequired,pathToData:i().array.isRequired};const co=Rn,kn=({isFormDisabled:o,kind:n,layout:a})=>{const[s,l]=(0,e.useState)(null),r=u=>{l(u===s?null:u)};return e.createElement(L.x,{padding:6,background:"neutral0"},a.map(({category:u,categoryId:p,childrenForm:v},y)=>e.createElement(co,{key:u,childrenForm:v,kind:n,isFormDisabled:o,isOpen:s===u,isWhite:y%2===1,name:u,onOpenCategory:r,pathToData:[n,p]})))};kn.propTypes={isFormDisabled:i().bool.isRequired,kind:i().string.isRequired,layout:i().arrayOf(i().shape({category:i().string.isRequired,categoryId:i().string.isRequired,childrenForm:i().arrayOf(i().shape({actions:i().array.isRequired})).isRequired}).isRequired).isRequired};const Gn=kn,wn=(o,n,a)=>o.find(s=>s.action===n&&s.subject===a),Kn=(o,n=[])=>o.reduce((a,s)=>(a[s.id]=n.indexOf(s.id)!==-1,a),{}),Vn=({children:o},n,a="")=>o.reduce((s,l)=>{if(l.children)return{...s,[l.value]:Vn(l,n,`${a}${l.value}.`)};const r=n.indexOf(`${a}${l.value}`)!==-1;return s[l.value]=r,s},{}),uo=(o,n,a)=>o.reduce((s,l)=>{const r=n.properties.find(({value:u})=>u===l);if(r){const u=(0,E.get)(a,["properties",r.value],[]),p=Vn(r,u);s.properties[l]=p}return s},{properties:{}}),mo=(o,n)=>n.reduce((a,s)=>{const l=o.find(({uid:r})=>r===s)||null;return l&&(a[s]=l),a},{}),Hn=({subjects:o},n,a,s=[])=>n.reduce((l,r)=>{const u=r.subjects,p=mo(o,u);if((0,E.isEmpty)(p))return l;const v=Object.keys(p).reduce((y,S)=>{const{actionId:A,applyToProperties:P}=r,z=p[S].properties.map(({value:ue})=>ue).every(ue=>(P||[]).indexOf(ue)===-1),D=wn(s,A,S),F=Kn(a,(0,E.get)(D,"conditions",[]));if((0,E.isEmpty)(P)||z)return(0,E.set)(y,[S,A],{properties:{enabled:D!==void 0},conditions:F}),y;const G=uo(P,p[S],D);return(0,E.set)(y,[S,A],{...G,conditions:F}),y},{});return(0,E.merge)(l,v)},{}),po=(o,n,a)=>o.reduce((s,l)=>{const r=wn(a,l.action,null);return s[l.action]={properties:{enabled:r!==void 0},conditions:Kn(n,(0,E.get)(r,"conditions",[]))},s},{}),go=(o,n,a)=>o.reduce((s,l)=>(s[l.subCategoryId]=po(l.actions,n,a),s),{}),Xn=(o,n,a=[])=>o.reduce((s,{categoryId:l,childrenForm:r})=>{const u=go(r,n,a);return s[l]=u,s},{}),Qn=o=>o.split(" ").join("-"),Yn=(o,n)=>(0,E.chain)(o).groupBy(n).map((a,s)=>({category:s,categoryId:Qn(s),childrenForm:(0,E.chain)(a).groupBy("subCategory").map((l,r)=>({subCategoryName:r,subCategoryId:Qn(r),actions:l})).value()})).value(),fo=(o,n)=>{const{conditions:a,sections:{collectionTypes:s,singleTypes:l,plugins:r,settings:u}}=o,p={collectionTypes:s,singleTypes:l,plugins:Yn(r,"plugin"),settings:Yn(u,"category")},v={collectionTypes:Hn(s,s.actions||[],a,n),singleTypes:Hn(l,l.actions||[],a,n),plugins:Xn(p.plugins,a,n),settings:Xn(p.settings,a,n)};return{initialData:v,modifiedData:v,layouts:p}},Jn=o=>Object.keys(o).reduce((n,a)=>{const s=o[a];if((0,E.isObject)(s)&&!(0,E.has)(s,"conditions"))return{...n,[a]:Jn(s)};if((0,E.isObject)(s)&&(0,E.has)(s,"conditions")&&!ft((0,E.omit)(s,"conditions")).some(r=>r)){const r=Object.keys(s.conditions).reduce((u,p)=>(u[p]=!1,u),{});return{...n,[a]:{...s,conditions:r}}}return n[a]=s,n},{}),Mn=Jn,qn=(o,n)=>Object.keys(o).reduce((a,s)=>{const l=o[s];return s==="conditions"?(a[s]=l,a):(0,E.isObject)(l)?{...a,[s]:qn(l,n)}:(a[s]=n,a)},{}),en=qn,ho={initialData:{},modifiedData:{},layouts:{}},Co=(o,n)=>(0,x.default)(o,a=>{switch(n.type){case"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX":{const{collectionTypeKind:s,actionId:l,value:r}=n,u=["modifiedData",s];Object.keys((0,E.get)(o,u)).forEach(p=>{const v=(0,E.get)(o,[...u,p,l],void 0);if(v){let y=en(v,r);if(!r&&y.conditions){const S=en(y.conditions,!1);y={...y,conditions:S}}(0,E.set)(a,[...u,p,l],y)}});break}case"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX":{const{pathToCollectionType:s,propertyName:l,rowName:r,value:u}=n;let p=(0,E.cloneDeep)(o.modifiedData);const v=s.split(".."),y=(0,E.get)(p,v,{});Object.keys(y).forEach(S=>{if((0,E.has)(y[S],`properties.${l}`)){const A=(0,E.get)(y,[S,"properties",l,r]),P=[...v,S,"properties",l,r];if(!(0,E.isObject)(A))(0,E.set)(p,P,u);else{const j=en(A,u);(0,E.set)(p,P,j)}}}),u||(p=Mn(p)),(0,E.set)(a,"modifiedData",p);break}case"ON_CHANGE_CONDITIONS":{Object.entries(n.conditions).forEach(s=>{const[l,r]=s;(0,E.set)(a,["modifiedData",...l.split(".."),"conditions"],r)});break}case"ON_CHANGE_SIMPLE_CHECKBOX":{let s=(0,E.cloneDeep)(o.modifiedData);(0,E.set)(s,[...n.keys.split("..")],n.value),n.value||(s=Mn(s)),(0,E.set)(a,"modifiedData",s);break}case"ON_CHANGE_TOGGLE_PARENT_CHECKBOX":{const{keys:s,value:l}=n,r=[...s.split("..")];let u=(0,E.cloneDeep)(o.modifiedData);const p=(0,E.get)(u,r,{}),v=en(p,l);(0,E.set)(u,r,v),l||(u=Mn(u)),(0,E.set)(a,["modifiedData"],u);break}case"RESET_FORM":{a.modifiedData=o.initialData;break}case"SET_FORM_AFTER_SUBMIT":{a.initialData=o.modifiedData;break}default:return a}}),Dn=o=>Object.entries(o).filter(([,n])=>n).map(([n])=>n),Eo=o=>{const[n,{conditions:a}]=o;return{action:n,subject:null,conditions:Dn(a),properties:{}}},vo=o=>Object.values(o).reduce((n,a)=>{const s=Object.entries(a).reduce((l,r)=>{const[,{properties:{enabled:u}}]=r;if(!u)return l;const p=Eo(r);return l.push(p),l},[]);return[...n,...s]},[]),_n=o=>Object.values(o).reduce((n,a)=>{const s=vo(a);return[...n,...s]},[]),eo=(o,n="")=>Object.entries(o).reduce((a,s)=>{const[l,r]=s;return(0,E.isObject)(r)?[...a,...eo(r,`${n}${l}.`)]:(r&&!(0,E.isObject)(r)&&a.push(`${n}${l}`),a)},[]),yo=(o,n,{conditions:a,properties:s})=>Object.entries(s).reduce((l,r)=>{const[u,p]=r;return l.properties[u]=eo(p),l},{action:o,subject:n,conditions:Dn(a),properties:{}}),So=(o,n,{conditions:a})=>({action:o,subject:n,properties:{},conditions:Dn(a)}),To=(o,n)=>Object.entries(n).reduce((s,l)=>{const[r,u]=l;if(!ft(u).some(y=>y))return s;if(!(0,E.has)(u,"properties.enabled")){const y=yo(r,o,u);return[...s,y]}if(!u.properties.enabled)return s;const v=So(r,o,u);return s.push(v),s},[]),to=o=>Object.entries(o).reduce((a,s)=>{const[l,r]=s,u=To(l,r);return[...a,...u]},[]),bo=o=>{const n=_n(o.plugins),a=_n(o.settings),s=to(o.collectionTypes),l=to(o.singleTypes);return[...n,...a,...s,...l]},Ao=[{labelId:"app.components.LeftMenuLinkContainer.collectionTypes",defaultMessage:"Collection Types",id:"collectionTypes"},{labelId:"app.components.LeftMenuLinkContainer.singleTypes",id:"singleTypes",defaultMessage:"Single Types"},{labelId:"app.components.LeftMenuLinkContainer.plugins",defaultMessage:"Plugins",id:"plugins"},{labelId:"app.components.LeftMenuLinkContainer.settings",defaultMessage:"Settings",id:"settings"}],Ln=(0,e.forwardRef)(({layout:o,isFormDisabled:n,permissions:a},s)=>{const[{initialData:l,layouts:r,modifiedData:u},p]=(0,e.useReducer)(Co,ho,()=>fo(o,a)),{formatMessage:v}=(0,X.useIntl)();(0,e.useImperativeHandle)(s,()=>({getPermissions(){const I=(0,ne.difference)(l.collectionTypes,u.collectionTypes),z=(0,ne.difference)(l.singleTypes,u.singleTypes),D={...I,...z};let F;return tt()(D)?F=!1:F=Object.values(D).some(G=>Object.values(G).some(ue=>Ze()(ue,"conditions"))),{permissionsToSend:bo(u),didUpdateConditions:F}},resetForm(){p({type:"RESET_FORM"})},setFormAfterSubmit(){p({type:"SET_FORM_AFTER_SUBMIT"})}}));const y=(I,z,D,F)=>{p({type:"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX",pathToCollectionType:I,propertyName:z,rowName:D,value:F})},S=(I,z,D)=>{p({type:"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX",collectionTypeKind:I,actionId:z,value:D})},A=I=>{p({type:"ON_CHANGE_CONDITIONS",conditions:I})},P=(0,e.useCallback)(({target:{name:I,value:z}})=>{p({type:"ON_CHANGE_SIMPLE_CHECKBOX",keys:I,value:z})},[]),j=(0,e.useCallback)(({target:{name:I,value:z}})=>{p({type:"ON_CHANGE_TOGGLE_PARENT_CHECKBOX",keys:I,value:z})},[]);return e.createElement(ot,{value:{availableConditions:o.conditions,modifiedData:u,onChangeConditions:A,onChangeSimpleCheckbox:P,onChangeParentCheckbox:j,onChangeCollectionTypeLeftActionRowCheckbox:y,onChangeCollectionTypeGlobalActionCheckbox:S}},e.createElement(Y.v,{id:"tabs",label:v({id:"Settings.permissions.users.tabs.label",defaultMessage:"Tabs Permissions"})},e.createElement(Qe.m,null,Ao.map(I=>e.createElement(Qe.O,{key:I.id},v({id:I.labelId,defaultMessage:I.defaultMessage})))),e.createElement(ie.n,{style:{position:"relative"}},e.createElement(ie.x,null,e.createElement(Fe,{layout:r.collectionTypes,kind:"collectionTypes",isFormDisabled:n})),e.createElement(ie.x,null,e.createElement(Fe,{layout:r.singleTypes,kind:"singleTypes",isFormDisabled:n})),e.createElement(ie.x,null,e.createElement(Gn,{layout:r.plugins,kind:"plugins",isFormDisabled:n})),e.createElement(ie.x,null,e.createElement(Gn,{layout:r.settings,kind:"settings",isFormDisabled:n})))))});Ln.defaultProps={permissions:[],layout:{conditions:[],sections:{collectionTypes:{},singleTypes:{actions:[]},settings:[],plugins:[]}}},Ln.propTypes={layout:i().object,isFormDisabled:i().bool.isRequired,permissions:i().array};const Ro=(0,e.memo)(Ln)},34341:(te,T,t)=>{t.d(T,{Z:()=>h});const h=!0},67500:(te,T,t)=>{t.d(T,{Z:()=>e});const e=()=>"todo empty role"},52351:(te,T,t)=>{t.d(T,{Z:()=>b});var e=t(67294),h=t(45697),i=t.n(h),ne=t(41580),Y=t(11047),Qe=t(47144),ie=t(18374),Pe=t(75515),Ze=t(12028),Ie=t(68547),tt=t.n(Ie),X=t(97132);const L=({id:be,name:$,description:Ae,usersCount:k,icons:je,rowIndex:ee})=>{const{formatMessage:B}=(0,X.useIntl)(),Ye=B({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:k});return e.createElement(Qe.Tr,{"aria-rowindex":ee,key:be,...(0,Ie.onRowClick)({fn:je[1].onClick})},e.createElement(ie.Td,{maxWidth:(0,Ie.pxToRem)(130)},e.createElement(Pe.Z,{ellipsis:!0,textColor:"neutral800"},$)),e.createElement(ie.Td,{maxWidth:(0,Ie.pxToRem)(250)},e.createElement(Pe.Z,{ellipsis:!0,textColor:"neutral800"},Ae)),e.createElement(ie.Td,null,e.createElement(Pe.Z,{textColor:"neutral800"},Ye)),e.createElement(ie.Td,null,e.createElement(Y.k,{justifyContent:"flex-end",...Ie.stopPropagation},je.map((w,f)=>w?e.createElement(ne.x,{key:w.label,paddingLeft:f===0?0:1},e.createElement(Ze.h,{onClick:w.onClick,label:w.label,noBorder:!0,icon:w.icon})):null))))};L.propTypes={id:i().number.isRequired,name:i().string.isRequired,description:i().string.isRequired,usersCount:i().number.isRequired,icons:i().array.isRequired,rowIndex:i().number.isRequired};const b=L},85302:(te,T,t)=>{t.d(T,{Z:()=>_e});var e=t(67294),h=t(68547),i=t(87751),ne=t(63852),Y=t(96315),Qe=t(20022),ie=t(4585),Pe=t(65186),Ze=t(29728),Ie=t(67838),tt=t(49066),X=t(11057),L=t(49386),b=t(63985),be=t(47144),$=t(18374),Ae=t(550),k=t(75515),je=t(185),ee=t(63237),B=t(97132),Ye=t(49656),w=t(52351),f=t(67500),ze=t(45697),le=t.n(ze),Ge=t(27821),we=t(44034),ct=t(25896),nt=t(12028),Ke=t(80994),at=t(41580),st=t(11047),it=t(7681),oe=t(17772),Je=t(70968);const re=t.p+"6d21938306785f176538.png",x=t.p+"617f9c948fa79e6d73bd.png",Ce=Ge.default.div`
  position: absolute;
  z-index: 3;
  inset: 0;
  background: ${({theme:R})=>(0,h.setHexOpacity)(R.colors.neutral800,.2)};
  padding: 0 ${({theme:R})=>R.spaces[8]};
`,N=(0,Ge.default)(st.k)`
  position: relative;
  max-width: ${830/16}rem;
  height: ${415/16}rem;
  margin: 0 auto;
  overflow: hidden;
  margin-top: 10%;
  padding-left: ${64/16}rem;

  img:first-of-type {
    position: absolute;
    right: 0;
    top: 0;
    max-width: ${360/16}rem;
  }

  img:not(:first-of-type) {
    width: ${130/16}rem;
    margin-left: 12%;
    margin-right: ${20/16}rem;
    z-index: 0;
  }
`,Ee=(0,Ge.default)(it.K)`
  align-items: flex-start;
  max-width: ${400/16}rem;
  z-index: 0;
`,J=(0,Ge.default)(at.x)`
  position: absolute;
  right: ${({theme:R})=>R.spaces[4]};
  top: ${({theme:R})=>R.spaces[4]};
`,ae=({onClose:R,isOpen:Z})=>{(0,h.useLockScroll)(Z);const{formatMessage:W}=(0,B.useIntl)();return Z?e.createElement(we.h,null,e.createElement(Ce,{onClick:R},e.createElement(ct.i,{onEscape:R},e.createElement(N,{onClick:se=>se.stopPropagation(),"aria-labelledby":"upgrade-plan",background:"neutral0",hasRadius:!0},e.createElement("img",{src:re,alt:"air-balloon"}),e.createElement(J,null,e.createElement(nt.h,{onClick:R,"aria-label":"Close",icon:e.createElement(Je.default,null)})),e.createElement(Ee,{spacing:6},e.createElement(k.Z,{fontWeight:"bold",textColor:"primary600"},W({id:"app.components.UpgradePlanModal.text-ce",defaultMessage:"COMMUNITY EDITION"})),e.createElement(it.K,{spacing:2},e.createElement(k.Z,{variant:"alpha",as:"h2",id:"upgrade-plan"},W({id:"app.components.UpgradePlanModal.limit-reached",defaultMessage:"You have reached the limit"})),e.createElement(k.Z,null,W({id:"app.components.UpgradePlanModal.text-power",defaultMessage:"Unlock the full power of Strapi by upgrading your plan to the Enterprise Edition"}))),e.createElement(Ke.Q,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(oe.Z,null)},W({id:"app.components.UpgradePlanModal.button",defaultMessage:"Learn more"}))),e.createElement("img",{src:x,alt:"upgrade-arrow"}))))):null};ae.propTypes={onClose:le().func.isRequired,isOpen:le().bool.isRequired};const Ue=ae;var Oe=t(48474);const ce=()=>{const{roles:R,isLoading:Z}=(0,Oe.bF)(),W=(0,h.useQuery)(),se=decodeURIComponent(W.get("_q")||""),K=(0,ne.ZP)(R,se,{keys:["name","description"]});return{isLoading:Z,sortedRoles:K}},Re=()=>{const{formatMessage:R}=(0,B.useIntl)(),[Z,W]=(0,e.useState)(!1),{trackUsage:se}=(0,h.useTracking)(),{push:K}=(0,Ye.useHistory)(),pe=(0,e.useCallback)(M=>{K(`/settings/roles/${M}`)},[K]),Me=(0,e.useCallback)(()=>{W(M=>!M)},[]),$e=(0,e.useCallback)(()=>{se("didShowRBACUpgradeModal"),W(!0)},[se]),dt=(0,e.useCallback)(M=>[{onClick:Me,label:R({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(Pe.Z,null)},{onClick:()=>pe(M.id),label:R({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(ie.Z,null)},{onClick:Me,label:R({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Qe.default,null)}],[R,Me,pe]);return{isModalOpen:Z,handleToggleModalForCreatingRole:$e,handleToggle:Me,getIcons:dt}},qe=()=>{const{formatMessage:R}=(0,B.useIntl)();(0,h.useFocusWhenNavigate)();const{sortedRoles:Z,isLoading:W}=ce(),{isModalOpen:se,handleToggle:K,handleToggleModalForCreatingRole:pe,getIcons:Me}=Re(),$e=Z.length+1,dt=5;return e.createElement(je.o,null,e.createElement(h.SettingsPageTitle,{name:"Roles"}),e.createElement(Ie.T,{primaryAction:e.createElement(Ze.z,{onClick:pe,startIcon:e.createElement(Y.default,null),size:"S"},R({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})),title:R({id:"global.roles",defaultMessage:"roles"}),subtitle:R({id:"Settings.roles.list.description",defaultMessage:"List of roles"})}),e.createElement(tt.D,null,e.createElement(X.i,{colCount:dt,rowCount:$e,footer:e.createElement(L.c,{onClick:pe,icon:e.createElement(Y.default,null)},R({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"}))},e.createElement(b.h,null,e.createElement(be.Tr,null,e.createElement($.Th,null,e.createElement(k.Z,{variant:"sigma",textColor:"neutral600"},R({id:"global.name",defaultMessage:"Name"}))),e.createElement($.Th,null,e.createElement(k.Z,{variant:"sigma",textColor:"neutral600"},R({id:"global.description",defaultMessage:"Description"}))),e.createElement($.Th,null,e.createElement(k.Z,{variant:"sigma",textColor:"neutral600"},R({id:"global.users",defaultMessage:"Users"}))),e.createElement($.Th,null,e.createElement(ee.T,null,R({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(Ae.p,null,Z?.map((M,ve)=>e.createElement(w.Z,{key:M.id,id:M.id,name:M.name,description:M.description,usersCount:M.usersCount,icons:Me(M),rowIndex:ve+2})))),!$e&&!W&&e.createElement(f.Z,null)),e.createElement(Ue,{isOpen:se,onClose:K}))},_e=()=>e.createElement(h.CheckPagePermissions,{permissions:i.Z.settings.roles.main},e.createElement(qe,null))},35301:(te,T,t)=>{t.d(T,{Z:()=>h});const h=[]},26789:(te,T,t)=>{t.d(T,{Z:()=>it});var e=t(67294),h=t(47292),i=t(68547),ne=t(41580),Y=t(29728),Qe=t(67838),ie=t(49066),Pe=t(11276),Ze=t(74571),Ie=t(185),tt=t(11047),X=t(7681),L=t(75515),b=t(16364),be=t(64256),$=t(67109),Ae=t(80831),k=t(27361),je=t.n(k),ee=t(41609),B=t.n(ee),Ye=t(97132),w=t(49656),f=t(27821),ze=t(28834),le=t(48474),Ge=t(87751),we=t(53209);const nt=we.Ry().shape({name:we.Z_().required(i.translatedErrors.required),description:we.Z_().required(i.translatedErrors.required)});var Ke=t(25108);const at=f.default.div`
  border: 1px solid ${({theme:oe})=>oe.colors.primary200};
  background: ${({theme:oe})=>oe.colors.primary100};
  padding: ${({theme:oe})=>`${oe.spaces[2]} ${oe.spaces[4]}`};
  color: ${({theme:oe})=>oe.colors.primary600};
  border-radius: ${({theme:oe})=>oe.borderRadius};
  font-size: ${12/16}rem;
  font-weight: bold;
`,st=()=>{const oe=(0,i.useNotification)(),{lockApp:Je,unlockApp:re}=(0,i.useOverlayBlocker)(),{formatMessage:x}=(0,Ye.useIntl)(),[Ce,N]=(0,e.useState)(!1),{replace:Ee}=(0,w.useHistory)(),J=(0,e.useRef)(),{trackUsage:ae}=(0,i.useTracking)(),Ue=(0,w.useRouteMatch)("/settings/roles/duplicate/:id"),Oe=je()(Ue,"params.id",null),{isLoading:ce,data:Re}=(0,le.U_)(),{permissions:Ve,isLoading:qe}=(0,le.Dq)(Oe),E=R=>{Je(),N(!0),ae(Oe?"willDuplicateRole":"willCreateNewRole"),Promise.resolve((0,i.request)("/admin/roles",{method:"POST",body:R})).then(async Z=>{const{permissionsToSend:W}=J.current.getPermissions();return ae(Oe?"didDuplicateRole":"didCreateNewRole"),Z.data.id&&!B()(W)&&await(0,i.request)(`/admin/roles/${Z.data.id}/permissions`,{method:"PUT",body:{permissions:W}}),Z}).then(Z=>{N(!1),oe({type:"success",message:{id:"Settings.roles.created",defaultMessage:"created"}}),Ee(`/settings/roles/${Z.data.id}`)}).catch(Z=>{Ke.error(Z),N(!1),oe({type:"warning",message:{id:"notification.error"}})}).finally(()=>{re()})},_e=`${x({id:"Settings.roles.form.created",defaultMessage:"Created"})} ${(0,h.format)(new Date,"PPP")}`;return e.createElement(Ie.o,null,e.createElement(i.SettingsPageTitle,{name:"Roles"}),e.createElement(Ae.Formik,{initialValues:{name:"",description:_e},onSubmit:E,validationSchema:nt,validateOnChange:!1},({handleSubmit:R,values:Z,errors:W,handleReset:se,handleChange:K})=>e.createElement(i.Form,{noValidate:!0},e.createElement(e.Fragment,null,e.createElement(Qe.T,{primaryAction:e.createElement(X.K,{horizontal:!0,spacing:2},e.createElement(Y.z,{variant:"secondary",onClick:()=>{se(),J.current.resetForm()},size:"L"},x({id:"app.components.Button.reset",defaultMessage:"Reset"})),e.createElement(Y.z,{onClick:R,loading:Ce,size:"L"},x({id:"global.save",defaultMessage:"Save"}))),title:x({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:x({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:e.createElement(i.Link,{startIcon:e.createElement($.Z,null),to:"/settings/roles"},x({id:"global.back",defaultMessage:"Back"}))}),e.createElement(ie.D,null,e.createElement(X.K,{spacing:6},e.createElement(ne.x,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(X.K,{spacing:4},e.createElement(tt.k,{justifyContent:"space-between"},e.createElement(ne.x,null,e.createElement(ne.x,null,e.createElement(L.Z,{fontWeight:"bold"},x({id:"global.details",defaultMessage:"Details"}))),e.createElement(ne.x,null,e.createElement(L.Z,{variant:"pi",textColor:"neutral600"},x({id:"Settings.roles.form.description",defaultMessage:"Name and description of the role"})))),e.createElement(at,null,x({id:"Settings.roles.form.button.users-with-role",defaultMessage:"{number, plural, =0 {# users} one {# user} other {# users}} with this role"},{number:0}))),e.createElement(Pe.r,{gap:4},e.createElement(Ze.P,{col:6},e.createElement(b.o,{name:"name",error:W.name&&x({id:W.name}),label:x({id:"global.name",defaultMessage:"Name"}),onChange:K,value:Z.name})),e.createElement(Ze.P,{col:6},e.createElement(be.g,{label:x({id:"global.description",defaultMessage:"Description"}),name:"description",error:W.description&&x({id:W.description}),onChange:K},Z.description))))),!ce&&!qe?e.createElement(ne.x,{shadow:"filterShadow",hasRadius:!0},e.createElement(ze.Z,{isFormDisabled:!1,ref:J,permissions:Ve,layout:Re})):e.createElement(ne.x,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(i.LoadingIndicatorPage,null))))))))};function it(){return e.createElement(i.CheckPagePermissions,{permissions:Ge.Z.settings.roles.create},e.createElement(st,null))}},53273:(te,T,t)=>{t.d(T,{Z:()=>h});const h=!1},20591:(te,T,t)=>{t.d(T,{Z:()=>h});const h=!1},74512:(te,T,t)=>{t.d(T,{Z:()=>h});const h=!1},76766:(te,T,t)=>{t.d(T,{Z:()=>h});const h=!1},85822:(te,T,t)=>{t.d(T,{Z:()=>h});const h=!1},8629:(te,T,t)=>{t.d(T,{Z:()=>h});const h=!1},64527:(te,T,t)=>{t.d(T,{Z:()=>re});var e=t(67294),h=t(68547),i=t(87751),ne=t(96315),Y=t(20022),Qe=t(65186),ie=t(4585),Pe=t(29728),Ze=t(67838),Ie=t(36989),tt=t(49066),X=t(63237),L=t(185),b=t(11057),be=t(49386),$=t(63985),Ae=t(47144),k=t(18374),je=t(550),ee=t(75515),B=t(96486),Ye=t(63852),w=t(97132),f=t(49656),ze=t(48474),le=t(67500),Ge=t(52351),we=t(18172);const ct={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},Ke=(x,Ce)=>(0,we.default)(x,N=>{switch(Ce.type){case"ON_REMOVE_ROLES":{N.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{N.shouldRefetchData=!0,N.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{N.shouldRefetchData=!1,N.roleToDelete=null,N.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{N.roleToDelete=Ce.id;break}default:return N}}),at=()=>{(0,h.useFocusWhenNavigate)();const{isLoading:x,allowedActions:{canCreate:Ce,canDelete:N,canRead:Ee,canUpdate:J}}=(0,h.useRBAC)(i.Z.settings.roles),{getData:ae,roles:Ue,isLoading:Oe}=(0,ze.bF)(!1),[{query:ce}]=(0,h.useQueryParams)(),Re=ce?._q||"",Ve=(0,Ye.ZP)(Ue,Re,{keys:["name","description"]});return(0,e.useEffect)(()=>{!x&&Ee&&ae()},[x,Ee,ae]),{isLoadingForPermissions:x,canCreate:Ce,canDelete:N,canRead:Ee,canUpdate:J,isLoading:Oe,getData:ae,sortedRoles:Ve,roles:Ue}},st=({getData:x,canCreate:Ce,canDelete:N,canUpdate:Ee})=>{const{formatMessage:J}=(0,w.useIntl)(),ae=(0,h.useNotification)(),[Ue,Oe]=(0,e.useState)(!1),{push:ce}=(0,f.useHistory)(),[{selectedRoles:Re,showModalConfirmButtonLoading:Ve,roleToDelete:qe},E]=(0,e.useReducer)(Ke,ct),{post:_e}=(0,h.getFetchClient)(),R=async()=>{try{E({type:"ON_REMOVE_ROLES"}),await _e("/admin/roles/batch-delete",{ids:[qe]}),await x(),E({type:"RESET_DATA_TO_DELETE"})}catch(M){const ve=(0,B.get)(M,["response","payload","data","ids"],null);if(ve&&Array.isArray(ve)){const ut=ve.join(`
`);ae({type:"warning",message:ut})}else ae({type:"warning",message:{id:"notification.error"}})}K()},Z=(0,e.useCallback)(M=>{ce(`/settings/roles/duplicate/${M}`)},[ce]),W=()=>ce("/settings/roles/new"),se=(0,e.useCallback)(M=>{E({type:"SET_ROLE_TO_DELETE",id:M}),K()},[]),K=()=>Oe(M=>!M),pe=(0,e.useCallback)(M=>{ce(`/settings/roles/${M}`)},[ce]),Me=(0,e.useCallback)((M,ve)=>{M.preventDefault(),M.stopPropagation(),ve.usersCount?ae({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):se(ve.id)},[ae,se]),$e=(0,e.useCallback)((M,ve)=>{M.preventDefault(),M.stopPropagation(),Z(ve.id)},[Z]),dt=(0,e.useCallback)(M=>[...Ce?[{onClick:ve=>$e(ve,M),label:J({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(Qe.Z,null)}]:[],...Ee?[{onClick:()=>pe(M.id),label:J({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(ie.Z,null)}]:[],...N?[{onClick:ve=>Me(ve,M),label:J({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Y.default,null)}]:[]],[J,Me,$e,pe,Ce,Ee,N]);return{handleNewRoleClick:W,getIcons:dt,selectedRoles:Re,isWarningDeleteAllOpened:Ue,showModalConfirmButtonLoading:Ve,handleToggleModal:K,handleDeleteData:R}},oe=()=>{const{formatMessage:x}=(0,w.useIntl)(),{isLoadingForPermissions:Ce,canCreate:N,canRead:Ee,canDelete:J,canUpdate:ae,isLoading:Ue,getData:Oe,sortedRoles:ce}=at(),{handleNewRoleClick:Re,getIcons:Ve,isWarningDeleteAllOpened:qe,showModalConfirmButtonLoading:E,handleToggleModal:_e,handleDeleteData:R}=st({getData:Oe,canCreate:N,canDelete:J,canUpdate:ae}),Z=ce.length+1,W=6;if(Ce)return e.createElement(L.o,null,e.createElement(h.LoadingIndicatorPage,null));const se=x({id:"global.roles",defaultMessage:"roles"});return e.createElement(L.o,null,e.createElement(h.SettingsPageTitle,{name:"Roles"}),e.createElement(Ze.T,{primaryAction:N?e.createElement(Pe.z,{onClick:Re,startIcon:e.createElement(ne.default,null),size:"S"},x({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:se,subtitle:x({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),Ee&&e.createElement(Ie.Z,{startActions:e.createElement(h.SearchURLQuery,{label:x({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:se})})}),Ee&&e.createElement(tt.D,null,e.createElement(b.i,{colCount:W,rowCount:Z,footer:N?e.createElement(be.c,{onClick:Re,icon:e.createElement(ne.default,null)},x({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement($.h,null,e.createElement(Ae.Tr,{"aria-rowindex":1},e.createElement(k.Th,null,e.createElement(ee.Z,{variant:"sigma",textColor:"neutral600"},x({id:"global.name",defaultMessage:"Name"}))),e.createElement(k.Th,null,e.createElement(ee.Z,{variant:"sigma",textColor:"neutral600"},x({id:"global.description",defaultMessage:"Description"}))),e.createElement(k.Th,null,e.createElement(ee.Z,{variant:"sigma",textColor:"neutral600"},x({id:"global.users",defaultMessage:"Users"}))),e.createElement(k.Th,null,e.createElement(X.T,null,x({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(je.p,null,ce?.map((K,pe)=>e.createElement(Ge.Z,{key:K.id,id:K.id,name:K.name,description:K.description,usersCount:K.usersCount,icons:Ve(K),rowIndex:pe+2})))),!Z&&!Ue&&e.createElement(le.Z,null)),e.createElement(h.ConfirmDialog,{isOpen:qe,onConfirm:R,isConfirmButtonLoading:E,onToggleDialog:_e}))},re=()=>e.createElement(h.CheckPagePermissions,{permissions:i.Z.settings.roles.main},e.createElement(oe,null))},5420:(te,T,t)=>{t.d(T,{Z:()=>h});const e=[];strapi.features.isEnabled(strapi.features.SSO)&&e.push({async Component(){return await t.e(302).then(t.bind(t,40316))},to:"/settings/single-sign-on",exact:!0}),strapi.features.isEnabled(strapi.features.AUDIT_LOGS)&&e.push({async Component(){return await Promise.all([t.e(4432),t.e(2812)]).then(t.bind(t,35915))},to:"/settings/audit-logs",exact:!0});const h=e}}]);
