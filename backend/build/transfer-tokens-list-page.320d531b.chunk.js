"use strict";(self.webpackChunkbackend=self.webpackChunkbackend||[]).push([[9600],{56856:(j,C,t)=>{t.d(C,{Z:()=>O});var e=t(67294),r=t(49656),R=t(45697),n=t.n(R),u=t(75515),B=t(550),P=t(47144),g=t(18374),U=t(11047),l=t(68547),I=t(20022),V=t(12028),b=t(41580),Z=t(97132);const D=({tokenName:a,onClickDelete:i})=>{const{formatMessage:T}=(0,Z.useIntl)(),{trackUsage:y}=(0,l.useTracking)();return e.createElement(b.x,{paddingLeft:1,...l.stopPropagation},e.createElement(V.h,{onClick:()=>{y("willDeleteToken"),i()},label:T({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${a}`}),name:"delete",noBorder:!0,icon:e.createElement(I.default,null)}))};D.propTypes={tokenName:n().string.isRequired,onClickDelete:n().func.isRequired};const x=D;var W=t(4585),$=t(27821);const z={edit:{id:"app.component.table.edit",defaultMessage:"Edit {target}"},read:{id:"app.component.table.read",defaultMessage:"Read {target}"}},F=(0,$.default)(l.Link)`
  svg {
    path {
      fill: ${({theme:a})=>a.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:a})=>a.colors.neutral800};
      }
    }
  }
`,h=({tokenName:a,tokenId:i,buttonType:T,children:y})=>{const{formatMessage:d}=(0,Z.useIntl)(),{location:{pathname:f}}=(0,r.useHistory)();return e.createElement(F,{to:`${f}/${i}`,title:d(z[T],{target:a})},y)};h.propTypes={tokenName:n().string.isRequired,tokenId:n().oneOfType([n().string,n().number]).isRequired,buttonType:n().string,children:n().node.isRequired},h.defaultProps={buttonType:"edit"};const m=h,E=({tokenName:a,tokenId:i})=>e.createElement(m,{tokenName:a,tokenId:i},e.createElement(W.Z,null));E.propTypes={tokenName:n().string.isRequired,tokenId:n().oneOfType([n().string,n().number]).isRequired};const k=E;var H=t(8934);const L=({tokenName:a,tokenId:i})=>e.createElement(m,{tokenName:a,tokenId:i,buttonType:"read"},e.createElement(H.default,null));L.propTypes={tokenName:n().string.isRequired,tokenId:n().oneOfType([n().string,n().number]).isRequired};const c=L,v=({permissions:a,headers:i,contentType:T,isLoading:y,tokens:d,onConfirmDelete:f})=>{const{canDelete:M,canUpdate:p,canRead:S}=a,A=M||p||S,[{query:N}]=(0,l.useQueryParams)(),[,Q]=N?N.sort.split(":"):"ASC",{push:o,location:{pathname:Y}}=(0,r.useHistory)(),{trackUsage:w}=(0,l.useTracking)(),J=d.sort((s,K)=>{const G=s.name.localeCompare(K.name);return Q==="DESC"?-G:G});return e.createElement(l.DynamicTable,{headers:i,contentType:T,rows:d,withBulkActions:A,isLoading:y,onConfirmDelete:f},e.createElement(B.p,null,J.map(s=>e.createElement(P.Tr,{key:s.id,...(0,l.onRowClick)({fn(){w("willEditTokenFromList"),o(`${Y}/${s.id}`)},condition:p})},e.createElement(g.Td,null,e.createElement(u.Z,{textColor:"neutral800",fontWeight:"bold"},s.name)),e.createElement(g.Td,{maxWidth:(0,l.pxToRem)(250)},e.createElement(u.Z,{textColor:"neutral800",ellipsis:!0},s.description)),e.createElement(g.Td,null,e.createElement(u.Z,{textColor:"neutral800"},e.createElement(l.RelativeTime,{timestamp:new Date(s.createdAt)}))),e.createElement(g.Td,null,s.lastUsedAt&&e.createElement(u.Z,{textColor:"neutral800"},e.createElement(l.RelativeTime,{timestamp:new Date(s.lastUsedAt)}))),A&&e.createElement(g.Td,null,e.createElement(U.k,{justifyContent:"end"},p&&e.createElement(k,{tokenName:s.name,tokenId:s.id}),!p&&S&&e.createElement(c,{tokenName:s.name,tokenId:s.id}),M&&e.createElement(x,{tokenName:s.name,onClickDelete:()=>f(s.id)})))))))};v.propTypes={tokens:n().array,permissions:n().shape({canRead:n().bool,canDelete:n().bool,canUpdate:n().bool}).isRequired,headers:n().arrayOf(n().shape({cellFormatter:n().func,key:n().string.isRequired,metadatas:n().shape({label:n().string.isRequired,sortable:n().bool}).isRequired,name:n().string.isRequired})),contentType:n().string.isRequired,isLoading:n().bool,onConfirmDelete:n().func},v.defaultProps={tokens:[],headers:[],isLoading:!1,onConfirmDelete(){}};const O=v},70798:(j,C,t)=>{t.r(C),t.d(C,{default:()=>F});var e=t(67294),r=t(68547),R=t(87751),n=t(97132),u=t(23724),B=t(49656),P=t(80129),g=t.n(P),U=t(67838),l=t(49066),I=t(185),V=t(29728),b=t(96315);const D=[{name:"name",key:"name",metadatas:{label:{id:"Settings.transferTokens.ListView.headers.name",defaultMessage:"Name"},sortable:!0}},{name:"description",key:"description",metadatas:{label:{id:"Settings.transferTokens.ListView.headers.description",defaultMessage:"Description"},sortable:!1}},{name:"createdAt",key:"createdAt",metadatas:{label:{id:"Settings.transferTokens.ListView.headers.createdAt",defaultMessage:"Created at"},sortable:!1}},{name:"lastUsedAt",key:"lastUsedAt",metadatas:{label:{id:"Settings.transferTokens.ListView.headers.lastUsedAt",defaultMessage:"Last used"},sortable:!1}}];var x=t(56856);const $=()=>{(0,r.useFocusWhenNavigate)();const h=(0,u.useQueryClient)(),{formatMessage:m}=(0,n.useIntl)(),E=(0,r.useNotification)(),{allowedActions:{canCreate:k,canDelete:H,canUpdate:L,canRead:c}}=(0,r.useRBAC)(R.Z.settings["transfer-tokens"]),{push:v}=(0,B.useHistory)(),{startSection:O}=(0,r.useGuidedTour)(),a=(0,e.useRef)(O),{get:i,del:T}=(0,r.useFetchClient)();(0,e.useEffect)(()=>{a.current&&a.current("transferTokens")},[]),(0,e.useEffect)(()=>{v({search:g().stringify({sort:"name:ASC"},{encode:!1})})},[v]);const y=D.map(o=>({...o,metadatas:{...o.metadatas,label:m(o.metadatas.label)}})),{data:d,status:f,isFetching:M}=(0,u.useQuery)(["transfer-tokens"],async()=>{const{data:{data:o}}=await i("/admin/transfer/tokens");return o},{enabled:c,onError(){E({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),p=c&&(f!=="success"&&f!=="error"||f==="success"&&M),S=(0,u.useMutation)(async o=>{await T(`/admin/transfer/tokens/${o}`)},{async onSuccess(){await h.invalidateQueries(["transfer-tokens"])},onError(o){o?.response?.data?.data?E({type:"warning",message:o.response.data.data}):E({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),A=c&&d,N=c&&!d&&!k,Q=c&&!d&&k;return e.createElement(I.o,{"aria-busy":p},e.createElement(r.SettingsPageTitle,{name:"Transfer Tokens"}),e.createElement(U.T,{title:m({id:"Settings.transferTokens.title",defaultMessage:"Transfer Tokens"}),subtitle:m({id:"Settings.transferTokens.description",defaultMessage:'"List of generated transfer tokens"'}),primaryAction:k?e.createElement(r.LinkButton,{"data-testid":"create-transfer-token-button",startIcon:e.createElement(b.default,null),size:"S",to:"/settings/transfer-tokens/create"},m({id:"Settings.transferTokens.create",defaultMessage:"Create new Transfer Token"})):void 0}),e.createElement(l.D,null,!c&&e.createElement(r.NoPermissions,null),A&&e.createElement(x.Z,{permissions:{canRead:c,canDelete:H,canUpdate:L},headers:y,contentType:"trasfer-tokens",rows:d,isLoading:p,onConfirmDelete:o=>S.mutateAsync(o),tokens:d}),Q&&e.createElement(r.NoContent,{content:{id:"Settings.transferTokens.addFirstToken",defaultMessage:"Add your first Transfer Token"},action:e.createElement(V.z,{variant:"secondary",startIcon:e.createElement(b.default,null)},m({id:"Settings.transferTokens.addNewToken",defaultMessage:"Add new Transfer Token"}))}),N&&e.createElement(r.NoContent,{content:{id:"Settings.transferTokens.emptyStateLayout",defaultMessage:"You don\u2019t have any content yet..."}})))},F=()=>e.createElement(r.CheckPagePermissions,{permissions:R.Z.settings["transfer-tokens"].main},e.createElement($,null))}}]);
